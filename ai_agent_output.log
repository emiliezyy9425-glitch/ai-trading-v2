
2025-10-29 12:07:46.724738: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 12:07:46.906837: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 12:07:46.973648: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 12:07:46.994913: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 12:07:47.110763: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 12:07:55,085 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
2025-10-29 12:07:56,096 [INFO] NVIDIA runtime not detected. Forcing TensorFlow to CPU mode before import.
2025-10-29 12:07:56.159688: E external/local_xla/xla/stream_executor/cuda/cuda_driver.cc:266] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2025-10-29 12:07:56,160 [INFO] No GPU detected. TensorFlow will run on CPU. If you expected GPU support, confirm the NVIDIA drivers, container runtime, and '--gpus all' flag (for Docker) are configured.
2025-10-29 12:07:56,291 [WARNING] Alpaca API credentials not configured; skipping data fetches.
2025-10-29 12:07:56,668 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 12:07:56,669 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 12:07:56,671 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 12:07:56,672 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 12:07:56,676 [INFO] Disconnecting
2025-10-29 12:07:56,677 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 12:07:56,677 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:07:56,683 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 12:07:56,684 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 12:08:01,685 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 12:08:01,685 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 12:08:01,689 [INFO] Disconnecting
2025-10-29 12:08:01,689 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 12:08:01,690 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:08:01,691 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 12:08:01,691 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 12:08:06,693 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 12:08:06,694 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 12:08:06,698 [INFO] Disconnecting
2025-10-29 12:08:06,698 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 12:08:06,698 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:08:06,700 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 12:08:06,705 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 12:08:06,706 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 12:08:06,707 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 12:08:06,707 [INFO] Disconnecting
2025-10-29 12:08:06,708 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 12:08:06,708 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:08:06,709 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:08:06,710 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 12:08:11,712 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 12:08:11,713 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 12:08:11,714 [INFO] Disconnecting
2025-10-29 12:08:11,714 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 12:08:11,714 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:08:11,716 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:08:11,716 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 12:08:16,717 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 12:08:16,717 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 12:08:16,718 [INFO] Disconnecting
2025-10-29 12:08:16,718 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 12:08:16,719 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:08:16,720 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:08:16,721 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:08:16,722 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 12:08:16,722 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 12:08:16,723 [INFO] Disconnecting
2025-10-29 12:08:16,724 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 12:08:16,726 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:08:16,726 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 12:08:21,727 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 12:08:21,727 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 12:08:21,728 [INFO] Disconnecting
2025-10-29 12:08:21,728 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 12:08:21,730 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:08:21,730 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 12:08:26,716 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 12:08:26,717 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 12:08:26,718 [INFO] Disconnecting
2025-10-29 12:08:26,718 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 12:08:26,719 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:08:26,721 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:08:26,721 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 12:08:26,721 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 12:08:26,722 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 12:08:26,724 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 13:11:13.428607: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 13:11:13.614161: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 13:11:13.680743: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 13:11:13.702374: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 13:11:13.820616: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 13:11:19,607 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
2025-10-29 13:11:20,621 [INFO] NVIDIA runtime not detected. Forcing TensorFlow to CPU mode before import.
2025-10-29 13:11:20.733249: E external/local_xla/xla/stream_executor/cuda/cuda_driver.cc:266] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2025-10-29 13:11:20,733 [INFO] No GPU detected. TensorFlow will run on CPU. If you expected GPU support, confirm the NVIDIA drivers, container runtime, and '--gpus all' flag (for Docker) are configured.
2025-10-29 13:11:20,857 [WARNING] Alpaca API credentials not configured; skipping data fetches.
2025-10-29 13:11:20,882 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 13:11:20,882 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 13:11:20,885 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 13:11:20,885 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 13:11:20,890 [INFO] Disconnecting
2025-10-29 13:11:20,890 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 13:11:20,891 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:11:20,894 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 13:11:20,894 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 13:11:25,888 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 13:11:25,889 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 13:11:25,892 [INFO] Disconnecting
2025-10-29 13:11:25,893 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 13:11:25,893 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:11:25,898 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 13:11:25,898 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 13:11:30,900 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 13:11:30,901 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 13:11:30,904 [INFO] Disconnecting
2025-10-29 13:11:30,905 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 13:11:30,905 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:11:30,906 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 13:11:30,908 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 13:11:30,909 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 13:11:30,909 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 13:11:30,910 [INFO] Disconnecting
2025-10-29 13:11:30,910 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 13:11:30,911 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:11:30,912 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:11:30,912 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 13:11:35,913 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 13:11:35,914 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 13:11:35,915 [INFO] Disconnecting
2025-10-29 13:11:35,915 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 13:11:35,915 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:11:35,917 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:11:35,917 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 13:11:40,918 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 13:11:40,919 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 13:11:40,920 [INFO] Disconnecting
2025-10-29 13:11:40,920 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 13:11:40,921 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:11:40,922 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:11:40,923 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:11:40,924 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 13:11:40,924 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 13:11:40,925 [INFO] Disconnecting
2025-10-29 13:11:40,926 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 13:11:40,927 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:11:40,927 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 13:11:45,928 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 13:11:45,928 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 13:11:45,929 [INFO] Disconnecting
2025-10-29 13:11:45,930 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 13:11:45,931 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:11:45,931 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 13:11:50,932 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 13:11:50,933 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 13:11:50,934 [INFO] Disconnecting
2025-10-29 13:11:50,935 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 13:11:50,936 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:11:50,937 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:11:50,938 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 13:11:50,938 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 13:11:50,939 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 13:11:50,941 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 06:00:02.749488: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 06:00:02.824111: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 06:00:02.851703: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 06:00:02.860379: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 06:00:02.918028: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 06:00:08,650 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761717608.744531   45068 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761717608.749578   45068 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761717608.749767   45068 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 06:00:08,750 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 06:00:08,822 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 06:00:08,839 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 06:00:08,840 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 06:00:08,841 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 06:00:08,841 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 06:00:08,842 [INFO] Downloading local price data for 1 tickers...
2025-10-29 06:00:08,847 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 06:00:08,848 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 06:00:08,854 [INFO] Disconnecting
2025-10-29 06:00:08,854 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 06:00:08,854 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 06:00:08,854 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 06:00:08,855 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 06:00:08,855 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 06:00:08,855 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 06:00:08,857 [INFO] Disconnecting
2025-10-29 06:00:08,857 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 06:00:08,858 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 06:00:08,858 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 06:00:08,858 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 06:00:08,858 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 06:00:08,859 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 06:00:08,861 [INFO] Disconnecting
2025-10-29 06:00:08,861 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 06:00:08,861 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 06:00:08,862 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 06:00:08,862 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 06:00:08,862 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 06:00:08,862 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 06:00:08,864 [INFO] Disconnecting
2025-10-29 06:00:08,865 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 06:00:08,865 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 06:00:08,865 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 06:00:08,865 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 06:00:08,865 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 06:00:08,866 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 06:00:08,868 [INFO] Disconnecting
2025-10-29 06:00:08,868 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 06:00:08,868 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 06:00:08,868 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 06:00:08,868 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 06:00:08,869 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 06:00:08,869 [WARNING] Failed to create historical_data.csv.
2025-10-29 06:00:08,870 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 06:00:08,870 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 06:00:08,872 [INFO] Disconnecting
2025-10-29 06:00:08,872 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 06:00:08,873 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 06:00:08,878 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 06:00:08,878 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 06:00:14,093 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 06:00:14,094 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 06:00:14,096 [INFO] Disconnecting
2025-10-29 06:00:14,097 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 06:00:14,097 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 06:00:14,098 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 06:00:14,098 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 06:00:19,101 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 06:00:19,102 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 06:00:19,105 [INFO] Disconnecting
2025-10-29 06:00:19,106 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 06:00:19,106 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 06:00:19,107 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 06:00:19,108 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 06:00:19,109 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 06:00:19,109 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 06:00:19,110 [INFO] Disconnecting
2025-10-29 06:00:19,110 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 06:00:19,110 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 06:00:19,111 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 06:00:19,111 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 06:00:24,098 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 06:00:24,098 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 06:00:24,101 [INFO] Disconnecting
2025-10-29 06:00:24,101 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 06:00:24,101 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 06:00:24,102 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 06:00:24,102 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 06:00:29,103 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 06:00:29,103 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 06:00:29,104 [INFO] Disconnecting
2025-10-29 06:00:29,105 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 06:00:29,105 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 06:00:29,106 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 06:00:29,107 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 06:00:29,108 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 06:00:29,108 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 06:00:29,109 [INFO] Disconnecting
2025-10-29 06:00:29,109 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 06:00:29,110 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 06:00:29,110 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 06:00:34,111 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 06:00:34,112 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 06:00:34,113 [INFO] Disconnecting
2025-10-29 06:00:34,115 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 06:00:34,116 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 06:00:34,116 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 06:00:39,118 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 06:00:39,119 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 06:00:39,122 [INFO] Disconnecting
2025-10-29 06:00:39,122 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 06:00:39,123 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 06:00:39,124 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 06:00:39,125 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 06:00:39,125 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 06:00:39,125 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 06:00:39,127 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 07:00:02.546784: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 07:00:02.579129: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 07:00:02.600412: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 07:00:02.607757: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 07:00:02.632794: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 07:00:06,472 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761721206.565608   45134 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761721206.567169   45134 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761721206.567336   45134 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 07:00:06,567 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 07:00:06,622 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 07:00:06,640 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 07:00:06,641 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 07:00:06,642 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 07:00:06,642 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 07:00:06,643 [INFO] Downloading local price data for 1 tickers...
2025-10-29 07:00:06,648 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 07:00:06,648 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 07:00:06,653 [INFO] Disconnecting
2025-10-29 07:00:06,653 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 07:00:06,653 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 07:00:06,653 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 07:00:06,654 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 07:00:06,654 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 07:00:06,654 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 07:00:06,656 [INFO] Disconnecting
2025-10-29 07:00:06,656 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 07:00:06,657 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 07:00:06,657 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 07:00:06,657 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 07:00:06,657 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 07:00:06,657 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 07:00:06,659 [INFO] Disconnecting
2025-10-29 07:00:06,660 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 07:00:06,660 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 07:00:06,660 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 07:00:06,660 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 07:00:06,660 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 07:00:06,661 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 07:00:06,662 [INFO] Disconnecting
2025-10-29 07:00:06,663 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 07:00:06,663 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 07:00:06,663 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 07:00:06,663 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 07:00:06,663 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 07:00:06,664 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 07:00:06,666 [INFO] Disconnecting
2025-10-29 07:00:06,666 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 07:00:06,666 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 07:00:06,666 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 07:00:06,666 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 07:00:06,667 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 07:00:06,667 [WARNING] Failed to create historical_data.csv.
2025-10-29 07:00:06,668 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 07:00:06,668 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 07:00:06,671 [INFO] Disconnecting
2025-10-29 07:00:06,671 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 07:00:06,671 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 07:00:06,673 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 07:00:06,673 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 07:00:11,866 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 07:00:11,867 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 07:00:11,870 [INFO] Disconnecting
2025-10-29 07:00:11,870 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 07:00:11,871 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 07:00:11,872 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 07:00:11,872 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 07:00:16,855 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 07:00:16,855 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 07:00:16,858 [INFO] Disconnecting
2025-10-29 07:00:16,859 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 07:00:16,859 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 07:00:16,860 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 07:00:16,861 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 07:00:16,862 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 07:00:16,862 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 07:00:16,863 [INFO] Disconnecting
2025-10-29 07:00:16,863 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 07:00:16,863 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 07:00:16,864 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 07:00:16,864 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 07:00:21,865 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 07:00:21,866 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 07:00:21,866 [INFO] Disconnecting
2025-10-29 07:00:21,867 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 07:00:21,867 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 07:00:21,868 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 07:00:21,869 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 07:00:26,870 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 07:00:26,871 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 07:00:26,871 [INFO] Disconnecting
2025-10-29 07:00:26,872 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 07:00:26,872 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 07:00:26,874 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 07:00:26,875 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 07:00:26,875 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 07:00:26,876 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 07:00:26,877 [INFO] Disconnecting
2025-10-29 07:00:26,877 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 07:00:26,878 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 07:00:26,878 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 07:00:31,880 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 07:00:31,881 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 07:00:31,882 [INFO] Disconnecting
2025-10-29 07:00:31,882 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 07:00:31,883 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 07:00:31,884 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 07:00:36,885 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 07:00:36,886 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 07:00:36,887 [INFO] Disconnecting
2025-10-29 07:00:36,887 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 07:00:36,888 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 07:00:36,890 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 07:00:36,890 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 07:00:36,891 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 07:00:36,891 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 07:00:36,893 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 08:00:02.152038: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 08:00:02.170135: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 08:00:02.184608: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 08:00:02.189636: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 08:00:02.202739: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 08:00:05,866 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761724805.957843   45200 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761724805.959443   45200 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761724805.959634   45200 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 08:00:05,959 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 08:00:06,014 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 08:00:06,033 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 08:00:06,033 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 08:00:06,034 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 08:00:06,035 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 08:00:06,035 [INFO] Downloading local price data for 1 tickers...
2025-10-29 08:00:06,040 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 08:00:06,040 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 08:00:06,045 [INFO] Disconnecting
2025-10-29 08:00:06,046 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 08:00:06,046 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 08:00:06,046 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 08:00:06,046 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 08:00:06,046 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 08:00:06,047 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 08:00:06,049 [INFO] Disconnecting
2025-10-29 08:00:06,049 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 08:00:06,049 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 08:00:06,049 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 08:00:06,049 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 08:00:06,050 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 08:00:06,050 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 08:00:06,052 [INFO] Disconnecting
2025-10-29 08:00:06,052 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 08:00:06,052 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 08:00:06,052 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 08:00:06,053 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 08:00:06,053 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 08:00:06,053 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 08:00:06,055 [INFO] Disconnecting
2025-10-29 08:00:06,055 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 08:00:06,055 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 08:00:06,055 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 08:00:06,056 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 08:00:06,056 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 08:00:06,056 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 08:00:06,058 [INFO] Disconnecting
2025-10-29 08:00:06,058 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 08:00:06,058 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 08:00:06,059 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 08:00:06,059 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 08:00:06,059 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 08:00:06,059 [WARNING] Failed to create historical_data.csv.
2025-10-29 08:00:06,061 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 08:00:06,061 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 08:00:06,063 [INFO] Disconnecting
2025-10-29 08:00:06,063 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 08:00:06,063 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 08:00:06,065 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 08:00:06,065 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 08:00:11,282 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 08:00:11,282 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 08:00:11,286 [INFO] Disconnecting
2025-10-29 08:00:11,286 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 08:00:11,286 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 08:00:11,287 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 08:00:11,288 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 08:00:16,263 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 08:00:16,264 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 08:00:16,267 [INFO] Disconnecting
2025-10-29 08:00:16,267 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 08:00:16,267 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 08:00:16,269 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 08:00:16,270 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 08:00:16,270 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 08:00:16,271 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 08:00:16,271 [INFO] Disconnecting
2025-10-29 08:00:16,272 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 08:00:16,272 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 08:00:16,273 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 08:00:16,273 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 08:00:21,274 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 08:00:21,274 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 08:00:21,275 [INFO] Disconnecting
2025-10-29 08:00:21,277 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 08:00:21,277 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 08:00:21,278 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 08:00:21,279 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 08:00:26,280 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 08:00:26,281 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 08:00:26,281 [INFO] Disconnecting
2025-10-29 08:00:26,283 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 08:00:26,283 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 08:00:26,285 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 08:00:26,286 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 08:00:26,287 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 08:00:26,287 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 08:00:26,288 [INFO] Disconnecting
2025-10-29 08:00:26,288 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 08:00:26,289 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 08:00:26,290 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 08:00:31,291 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 08:00:31,292 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 08:00:31,293 [INFO] Disconnecting
2025-10-29 08:00:31,294 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 08:00:31,295 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 08:00:31,296 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 08:00:36,298 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 08:00:36,299 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 08:00:36,300 [INFO] Disconnecting
2025-10-29 08:00:36,301 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 08:00:36,303 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 08:00:36,304 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 08:00:36,304 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 08:00:36,305 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 08:00:36,305 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 08:00:36,307 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 09:00:01.642454: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 09:00:01.655244: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 09:00:01.667787: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 09:00:01.672092: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 09:00:01.682719: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 09:00:05,205 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761728405.297225   45266 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761728405.298795   45266 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761728405.298992   45266 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 09:00:05,299 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 09:00:05,355 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 09:00:05,373 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 09:00:05,374 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 09:00:05,375 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 09:00:05,375 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 09:00:05,375 [INFO] Downloading local price data for 1 tickers...
2025-10-29 09:00:05,381 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 09:00:05,381 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 09:00:05,385 [INFO] Disconnecting
2025-10-29 09:00:05,385 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 09:00:05,385 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 09:00:05,386 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 09:00:05,386 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 09:00:05,386 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 09:00:05,386 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 09:00:05,388 [INFO] Disconnecting
2025-10-29 09:00:05,388 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 09:00:05,389 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 09:00:05,389 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 09:00:05,389 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 09:00:05,389 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 09:00:05,389 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 09:00:05,391 [INFO] Disconnecting
2025-10-29 09:00:05,392 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 09:00:05,392 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 09:00:05,392 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 09:00:05,392 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 09:00:05,392 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 09:00:05,393 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 09:00:05,394 [INFO] Disconnecting
2025-10-29 09:00:05,395 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 09:00:05,395 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 09:00:05,395 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 09:00:05,395 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 09:00:05,395 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 09:00:05,396 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 09:00:05,397 [INFO] Disconnecting
2025-10-29 09:00:05,398 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 09:00:05,398 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 09:00:05,398 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 09:00:05,398 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 09:00:05,398 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 09:00:05,399 [WARNING] Failed to create historical_data.csv.
2025-10-29 09:00:05,400 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 09:00:05,400 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 09:00:05,402 [INFO] Disconnecting
2025-10-29 09:00:05,402 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 09:00:05,403 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 09:00:05,405 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 09:00:05,405 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 09:00:10,616 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 09:00:10,617 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 09:00:10,621 [INFO] Disconnecting
2025-10-29 09:00:10,621 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 09:00:10,621 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 09:00:10,622 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 09:00:10,623 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 09:00:15,595 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 09:00:15,596 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 09:00:15,599 [INFO] Disconnecting
2025-10-29 09:00:15,599 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 09:00:15,599 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 09:00:15,601 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 09:00:15,602 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 09:00:15,603 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 09:00:15,603 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 09:00:15,604 [INFO] Disconnecting
2025-10-29 09:00:15,604 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 09:00:15,604 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 09:00:15,605 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 09:00:15,605 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 09:00:20,606 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 09:00:20,607 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 09:00:20,607 [INFO] Disconnecting
2025-10-29 09:00:20,609 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 09:00:20,609 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 09:00:20,610 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 09:00:20,610 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 09:00:25,611 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 09:00:25,612 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 09:00:25,613 [INFO] Disconnecting
2025-10-29 09:00:25,614 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 09:00:25,615 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 09:00:25,616 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 09:00:25,617 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 09:00:25,618 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 09:00:25,618 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 09:00:25,619 [INFO] Disconnecting
2025-10-29 09:00:25,619 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 09:00:25,620 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 09:00:25,620 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 09:00:30,621 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 09:00:30,622 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 09:00:30,623 [INFO] Disconnecting
2025-10-29 09:00:30,623 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 09:00:30,624 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 09:00:30,625 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 09:00:35,625 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 09:00:35,626 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 09:00:35,627 [INFO] Disconnecting
2025-10-29 09:00:35,628 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 09:00:35,629 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 09:00:35,630 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 09:00:35,631 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 09:00:35,631 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 09:00:35,631 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 09:00:35,634 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 10:00:01.699860: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 10:00:01.713550: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 10:00:01.727005: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 10:00:01.731880: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 10:00:01.743662: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 10:00:05,310 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761732005.406139   45332 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761732005.407558   45332 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761732005.407773   45332 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 10:00:05,408 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 10:00:05,461 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 10:00:05,479 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 10:00:05,480 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 10:00:05,481 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 10:00:05,481 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 10:00:05,481 [INFO] Downloading local price data for 1 tickers...
2025-10-29 10:00:05,486 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 10:00:05,487 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 10:00:05,492 [INFO] Disconnecting
2025-10-29 10:00:05,492 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 10:00:05,492 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 10:00:05,492 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 10:00:05,492 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 10:00:05,493 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 10:00:05,493 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 10:00:05,495 [INFO] Disconnecting
2025-10-29 10:00:05,495 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 10:00:05,495 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 10:00:05,496 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 10:00:05,496 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 10:00:05,496 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 10:00:05,496 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 10:00:05,498 [INFO] Disconnecting
2025-10-29 10:00:05,498 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 10:00:05,498 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 10:00:05,499 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 10:00:05,499 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 10:00:05,499 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 10:00:05,499 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 10:00:05,501 [INFO] Disconnecting
2025-10-29 10:00:05,501 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 10:00:05,501 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 10:00:05,502 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 10:00:05,502 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 10:00:05,502 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 10:00:05,502 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 10:00:05,504 [INFO] Disconnecting
2025-10-29 10:00:05,504 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 10:00:05,504 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 10:00:05,505 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 10:00:05,505 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 10:00:05,505 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 10:00:05,505 [WARNING] Failed to create historical_data.csv.
2025-10-29 10:00:05,506 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 10:00:05,507 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 10:00:05,509 [INFO] Disconnecting
2025-10-29 10:00:05,509 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 10:00:05,509 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 10:00:05,511 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 10:00:05,511 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 10:00:10,701 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 10:00:10,702 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 10:00:10,705 [INFO] Disconnecting
2025-10-29 10:00:10,705 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 10:00:10,705 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 10:00:10,707 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 10:00:10,707 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 10:00:15,707 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 10:00:15,708 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 10:00:15,712 [INFO] Disconnecting
2025-10-29 10:00:15,712 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 10:00:15,712 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 10:00:15,713 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 10:00:15,715 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 10:00:15,716 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 10:00:15,716 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 10:00:15,716 [INFO] Disconnecting
2025-10-29 10:00:15,717 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 10:00:15,717 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 10:00:15,718 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 10:00:15,718 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 10:00:20,719 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 10:00:20,720 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 10:00:20,720 [INFO] Disconnecting
2025-10-29 10:00:20,720 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 10:00:20,720 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 10:00:20,722 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 10:00:20,722 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 10:00:25,725 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 10:00:25,726 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 10:00:25,727 [INFO] Disconnecting
2025-10-29 10:00:25,728 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 10:00:25,728 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 10:00:25,730 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 10:00:25,731 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 10:00:25,731 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 10:00:25,732 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 10:00:25,733 [INFO] Disconnecting
2025-10-29 10:00:25,733 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 10:00:25,734 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 10:00:25,735 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 10:00:30,736 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 10:00:30,737 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 10:00:30,738 [INFO] Disconnecting
2025-10-29 10:00:30,738 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 10:00:30,739 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 10:00:30,740 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 10:00:35,740 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 10:00:35,741 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 10:00:35,742 [INFO] Disconnecting
2025-10-29 10:00:35,743 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 10:00:35,744 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 10:00:35,745 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 10:00:35,745 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 10:00:35,746 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 10:00:35,746 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 10:00:35,749 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 11:00:01.630882: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 11:00:01.643518: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 11:00:01.657446: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 11:00:01.662236: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 11:00:01.673563: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 11:00:05,303 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761735605.397217   45398 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761735605.398869   45398 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761735605.399076   45398 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 11:00:05,399 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 11:00:05,454 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 11:00:05,472 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 11:00:05,472 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 11:00:05,473 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 11:00:05,474 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 11:00:05,474 [INFO] Downloading local price data for 1 tickers...
2025-10-29 11:00:05,479 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 11:00:05,480 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 11:00:05,484 [INFO] Disconnecting
2025-10-29 11:00:05,484 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 11:00:05,484 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 11:00:05,485 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 11:00:05,485 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 11:00:05,485 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 11:00:05,485 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 11:00:05,487 [INFO] Disconnecting
2025-10-29 11:00:05,487 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 11:00:05,488 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 11:00:05,488 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 11:00:05,488 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 11:00:05,488 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 11:00:05,488 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 11:00:05,490 [INFO] Disconnecting
2025-10-29 11:00:05,491 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 11:00:05,491 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 11:00:05,491 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 11:00:05,491 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 11:00:05,491 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 11:00:05,492 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 11:00:05,494 [INFO] Disconnecting
2025-10-29 11:00:05,494 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 11:00:05,494 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 11:00:05,494 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 11:00:05,494 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 11:00:05,495 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 11:00:05,495 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 11:00:05,497 [INFO] Disconnecting
2025-10-29 11:00:05,497 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 11:00:05,497 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 11:00:05,497 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 11:00:05,498 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 11:00:05,498 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 11:00:05,498 [WARNING] Failed to create historical_data.csv.
2025-10-29 11:00:05,499 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 11:00:05,500 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 11:00:05,501 [INFO] Disconnecting
2025-10-29 11:00:05,502 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 11:00:05,502 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 11:00:05,504 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 11:00:05,505 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 11:00:10,686 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 11:00:10,687 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 11:00:10,690 [INFO] Disconnecting
2025-10-29 11:00:10,690 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 11:00:10,690 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 11:00:10,691 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 11:00:10,692 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 11:00:15,692 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 11:00:15,693 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 11:00:15,696 [INFO] Disconnecting
2025-10-29 11:00:15,697 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 11:00:15,697 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 11:00:15,698 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 11:00:15,700 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 11:00:15,700 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 11:00:15,701 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 11:00:15,702 [INFO] Disconnecting
2025-10-29 11:00:15,702 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 11:00:15,702 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 11:00:15,703 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 11:00:15,704 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 11:00:20,705 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 11:00:20,706 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 11:00:20,706 [INFO] Disconnecting
2025-10-29 11:00:20,708 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 11:00:20,709 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 11:00:20,710 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 11:00:20,710 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 11:00:25,712 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 11:00:25,713 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 11:00:25,714 [INFO] Disconnecting
2025-10-29 11:00:25,714 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 11:00:25,714 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 11:00:25,715 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 11:00:25,716 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 11:00:25,717 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 11:00:25,717 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 11:00:25,718 [INFO] Disconnecting
2025-10-29 11:00:25,719 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 11:00:25,720 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 11:00:25,720 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 11:00:30,725 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 11:00:30,726 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 11:00:30,727 [INFO] Disconnecting
2025-10-29 11:00:30,727 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 11:00:30,728 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 11:00:30,728 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 11:00:35,732 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 11:00:35,733 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 11:00:35,734 [INFO] Disconnecting
2025-10-29 11:00:35,736 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 11:00:35,737 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 11:00:35,738 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 11:00:35,739 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 11:00:35,739 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 11:00:35,739 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 11:00:35,742 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 12:00:02.199861: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 12:00:02.232979: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 12:00:02.248882: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 12:00:02.253539: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 12:00:02.276437: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 12:00:06,678 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761739206.772255   45464 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761739206.774183   45464 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761739206.774375   45464 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 12:00:06,774 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 12:00:06,833 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 12:00:06,852 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 12:00:06,852 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 12:00:06,853 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 12:00:06,854 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 12:00:06,854 [INFO] Downloading local price data for 1 tickers...
2025-10-29 12:00:06,859 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 12:00:06,859 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 12:00:06,864 [INFO] Disconnecting
2025-10-29 12:00:06,864 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 12:00:06,864 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:00:06,864 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 12:00:06,865 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 12:00:06,865 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 12:00:06,865 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 12:00:06,867 [INFO] Disconnecting
2025-10-29 12:00:06,867 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 12:00:06,868 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:00:06,868 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 12:00:06,868 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 12:00:06,868 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 12:00:06,868 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 12:00:06,870 [INFO] Disconnecting
2025-10-29 12:00:06,871 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 12:00:06,871 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:00:06,871 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 12:00:06,871 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 12:00:06,871 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 12:00:06,872 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 12:00:06,874 [INFO] Disconnecting
2025-10-29 12:00:06,874 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 12:00:06,874 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:00:06,874 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 12:00:06,875 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 12:00:06,875 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 12:00:06,875 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 12:00:06,877 [INFO] Disconnecting
2025-10-29 12:00:06,877 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 12:00:06,877 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:00:06,877 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 12:00:06,878 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 12:00:06,878 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 12:00:06,878 [WARNING] Failed to create historical_data.csv.
2025-10-29 12:00:06,879 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 12:00:06,880 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 12:00:06,882 [INFO] Disconnecting
2025-10-29 12:00:06,882 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 12:00:06,882 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:00:06,886 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 12:00:06,886 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 12:00:12,096 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 12:00:12,097 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 12:00:12,100 [INFO] Disconnecting
2025-10-29 12:00:12,101 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 12:00:12,101 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:00:12,102 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 12:00:12,102 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 12:00:17,103 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 12:00:17,104 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 12:00:17,107 [INFO] Disconnecting
2025-10-29 12:00:17,108 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 12:00:17,108 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:00:17,109 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 12:00:17,111 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 12:00:17,112 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 12:00:17,112 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 12:00:17,113 [INFO] Disconnecting
2025-10-29 12:00:17,113 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 12:00:17,113 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:00:17,114 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:00:17,114 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 12:00:22,115 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 12:00:22,116 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 12:00:22,117 [INFO] Disconnecting
2025-10-29 12:00:22,118 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 12:00:22,118 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:00:22,120 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:00:22,120 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 12:00:27,122 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 12:00:27,122 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 12:00:27,123 [INFO] Disconnecting
2025-10-29 12:00:27,125 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 12:00:27,125 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 12:00:27,126 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:00:27,128 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:00:27,128 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 12:00:27,129 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 12:00:27,130 [INFO] Disconnecting
2025-10-29 12:00:27,130 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 12:00:27,131 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:00:27,132 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 12:00:32,134 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 12:00:32,135 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 12:00:32,136 [INFO] Disconnecting
2025-10-29 12:00:32,136 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 12:00:32,137 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:00:32,138 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 12:00:37,099 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 12:00:37,100 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 12:00:37,101 [INFO] Disconnecting
2025-10-29 12:00:37,102 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 12:00:37,104 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:00:37,105 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 12:00:37,105 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 12:00:37,106 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 12:00:37,106 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 12:00:37,109 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 13:00:03.599292: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 13:00:03.735818: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 13:00:03.781881: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 13:00:03.795258: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 13:00:03.874829: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 13:00:10,539 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761742810.665342   45530 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761742810.671134   45530 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761742810.671357   45530 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 13:00:10,671 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 13:00:10,740 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 13:00:10,760 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 13:00:10,761 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 13:00:10,762 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 13:00:10,762 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 13:00:10,763 [INFO] Downloading local price data for 1 tickers...
2025-10-29 13:00:10,768 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 13:00:10,768 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 13:00:10,777 [INFO] Disconnecting
2025-10-29 13:00:10,777 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 13:00:10,777 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:00:10,778 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 13:00:10,778 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 13:00:10,778 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 13:00:10,778 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 13:00:10,780 [INFO] Disconnecting
2025-10-29 13:00:10,781 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 13:00:10,781 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:00:10,781 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 13:00:10,781 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 13:00:10,781 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 13:00:10,782 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 13:00:10,783 [INFO] Disconnecting
2025-10-29 13:00:10,784 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 13:00:10,784 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:00:10,784 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 13:00:10,784 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 13:00:10,784 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 13:00:10,785 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 13:00:10,786 [INFO] Disconnecting
2025-10-29 13:00:10,787 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 13:00:10,787 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:00:10,787 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 13:00:10,787 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 13:00:10,787 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 13:00:10,788 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 13:00:10,790 [INFO] Disconnecting
2025-10-29 13:00:10,790 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 13:00:10,790 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:00:10,790 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 13:00:10,790 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 13:00:10,791 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 13:00:10,791 [WARNING] Failed to create historical_data.csv.
2025-10-29 13:00:10,792 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 13:00:10,792 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 13:00:10,794 [INFO] Disconnecting
2025-10-29 13:00:10,794 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 13:00:10,795 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:00:10,798 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 13:00:10,799 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 13:00:16,007 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 13:00:16,008 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 13:00:16,011 [INFO] Disconnecting
2025-10-29 13:00:16,011 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 13:00:16,012 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:00:16,013 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 13:00:16,013 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 13:00:21,014 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 13:00:21,015 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 13:00:21,020 [INFO] Disconnecting
2025-10-29 13:00:21,020 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 13:00:21,021 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:00:21,022 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 13:00:21,024 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 13:00:21,024 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 13:00:21,024 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 13:00:21,025 [INFO] Disconnecting
2025-10-29 13:00:21,025 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 13:00:21,025 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:00:21,026 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:00:21,027 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 13:00:26,028 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 13:00:26,029 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 13:00:26,029 [INFO] Disconnecting
2025-10-29 13:00:26,031 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 13:00:26,032 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:00:26,033 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:00:26,033 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 13:00:31,034 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 13:00:31,035 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 13:00:31,035 [INFO] Disconnecting
2025-10-29 13:00:31,036 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 13:00:31,036 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 13:00:31,037 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:00:31,039 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:00:31,039 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 13:00:31,039 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 13:00:31,041 [INFO] Disconnecting
2025-10-29 13:00:31,041 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 13:00:31,042 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:00:31,042 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 13:00:36,031 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 13:00:36,032 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 13:00:36,033 [INFO] Disconnecting
2025-10-29 13:00:36,034 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 13:00:36,035 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:00:36,036 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 13:00:41,036 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 13:00:41,037 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 13:00:41,038 [INFO] Disconnecting
2025-10-29 13:00:41,040 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 13:00:41,041 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:00:41,042 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 13:00:41,042 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 13:00:41,043 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 13:00:41,043 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 13:00:41,045 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 14:00:01.653792: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 14:00:01.666747: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 14:00:01.680321: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 14:00:01.684721: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 14:00:01.695998: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 14:00:05,260 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761746405.352019   45596 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761746405.353736   45596 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761746405.353928   45596 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 14:00:05,354 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 14:00:05,409 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 14:00:05,428 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 14:00:05,428 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 14:00:05,429 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 14:00:05,430 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 14:00:05,430 [INFO] Downloading local price data for 1 tickers...
2025-10-29 14:00:05,435 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 14:00:05,435 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 14:00:05,441 [INFO] Disconnecting
2025-10-29 14:00:05,442 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 14:00:05,442 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 14:00:05,442 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 14:00:05,442 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 14:00:05,442 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 14:00:05,443 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 14:00:05,445 [INFO] Disconnecting
2025-10-29 14:00:05,445 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 14:00:05,445 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 14:00:05,445 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 14:00:05,445 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 14:00:05,446 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 14:00:05,446 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 14:00:05,448 [INFO] Disconnecting
2025-10-29 14:00:05,448 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 14:00:05,448 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 14:00:05,448 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 14:00:05,449 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 14:00:05,449 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 14:00:05,449 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 14:00:05,451 [INFO] Disconnecting
2025-10-29 14:00:05,451 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 14:00:05,451 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 14:00:05,452 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 14:00:05,452 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 14:00:05,452 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 14:00:05,452 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 14:00:05,454 [INFO] Disconnecting
2025-10-29 14:00:05,454 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 14:00:05,455 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 14:00:05,455 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 14:00:05,455 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 14:00:05,455 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 14:00:05,455 [WARNING] Failed to create historical_data.csv.
2025-10-29 14:00:05,457 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 14:00:05,457 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 14:00:05,459 [INFO] Disconnecting
2025-10-29 14:00:05,459 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 14:00:05,460 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 14:00:05,462 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 14:00:05,462 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 14:00:10,640 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 14:00:10,640 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 14:00:10,643 [INFO] Disconnecting
2025-10-29 14:00:10,643 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 14:00:10,644 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 14:00:10,645 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 14:00:10,645 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 14:00:15,646 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 14:00:15,647 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 14:00:15,650 [INFO] Disconnecting
2025-10-29 14:00:15,650 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 14:00:15,651 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 14:00:15,652 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 14:00:15,653 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 14:00:15,654 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 14:00:15,654 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 14:00:15,655 [INFO] Disconnecting
2025-10-29 14:00:15,655 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 14:00:15,655 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 14:00:15,656 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 14:00:15,656 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 14:00:20,657 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 14:00:20,657 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 14:00:20,658 [INFO] Disconnecting
2025-10-29 14:00:20,661 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 14:00:20,661 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 14:00:20,662 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 14:00:20,663 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 14:00:25,663 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 14:00:25,664 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 14:00:25,665 [INFO] Disconnecting
2025-10-29 14:00:25,666 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 14:00:25,667 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 14:00:25,668 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 14:00:25,669 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 14:00:25,670 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 14:00:25,670 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 14:00:25,671 [INFO] Disconnecting
2025-10-29 14:00:25,671 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 14:00:25,672 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 14:00:25,673 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 14:00:30,639 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 14:00:30,639 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 14:00:30,641 [INFO] Disconnecting
2025-10-29 14:00:30,643 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 14:00:30,644 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 14:00:30,644 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 14:00:35,646 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 14:00:35,646 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 14:00:35,647 [INFO] Disconnecting
2025-10-29 14:00:35,648 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 14:00:35,649 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 14:00:35,650 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 14:00:35,650 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 14:00:35,651 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 14:00:35,651 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 14:00:35,653 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 15:00:03.044187: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 15:00:03.178409: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 15:00:03.222154: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 15:00:03.234802: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 15:00:03.313737: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 15:00:09,971 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761750010.090396   45662 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761750010.096216   45662 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761750010.096443   45662 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 15:00:10,096 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 15:00:10,166 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 15:00:10,185 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 15:00:10,185 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 15:00:10,186 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 15:00:10,187 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 15:00:10,187 [INFO] Downloading local price data for 1 tickers...
2025-10-29 15:00:10,192 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 15:00:10,192 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 15:00:10,201 [INFO] Disconnecting
2025-10-29 15:00:10,201 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 15:00:10,201 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 15:00:10,202 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 15:00:10,202 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 15:00:10,202 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 15:00:10,202 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 15:00:10,205 [INFO] Disconnecting
2025-10-29 15:00:10,205 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 15:00:10,205 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 15:00:10,205 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 15:00:10,205 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 15:00:10,206 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 15:00:10,206 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 15:00:10,208 [INFO] Disconnecting
2025-10-29 15:00:10,208 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 15:00:10,208 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 15:00:10,208 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 15:00:10,208 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 15:00:10,209 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 15:00:10,209 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 15:00:10,211 [INFO] Disconnecting
2025-10-29 15:00:10,211 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 15:00:10,212 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 15:00:10,212 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 15:00:10,212 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 15:00:10,212 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 15:00:10,212 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 15:00:10,214 [INFO] Disconnecting
2025-10-29 15:00:10,214 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 15:00:10,214 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 15:00:10,215 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 15:00:10,215 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 15:00:10,215 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 15:00:10,215 [WARNING] Failed to create historical_data.csv.
2025-10-29 15:00:10,216 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 15:00:10,216 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 15:00:10,218 [INFO] Disconnecting
2025-10-29 15:00:10,219 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 15:00:10,219 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 15:00:10,222 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 15:00:10,223 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 15:00:15,434 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 15:00:15,435 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 15:00:15,438 [INFO] Disconnecting
2025-10-29 15:00:15,438 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 15:00:15,438 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 15:00:15,439 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 15:00:15,440 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 15:00:20,443 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 15:00:20,444 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 15:00:20,448 [INFO] Disconnecting
2025-10-29 15:00:20,448 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 15:00:20,448 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 15:00:20,450 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 15:00:20,452 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 15:00:20,452 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 15:00:20,453 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 15:00:20,453 [INFO] Disconnecting
2025-10-29 15:00:20,453 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 15:00:20,453 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 15:00:20,454 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 15:00:20,455 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 15:00:25,456 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 15:00:25,456 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 15:00:25,457 [INFO] Disconnecting
2025-10-29 15:00:25,457 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 15:00:25,457 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 15:00:25,459 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 15:00:25,459 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 15:00:30,414 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 15:00:30,415 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 15:00:30,416 [INFO] Disconnecting
2025-10-29 15:00:30,416 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 15:00:30,416 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 15:00:30,417 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 15:00:30,418 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 15:00:30,419 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 15:00:30,419 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 15:00:30,420 [INFO] Disconnecting
2025-10-29 15:00:30,421 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 15:00:30,422 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 15:00:30,422 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 15:00:35,422 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 15:00:35,423 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 15:00:35,424 [INFO] Disconnecting
2025-10-29 15:00:35,424 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 15:00:35,426 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 15:00:35,426 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 15:00:40,427 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 15:00:40,428 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 15:00:40,429 [INFO] Disconnecting
2025-10-29 15:00:40,429 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 15:00:40,430 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 15:00:40,432 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 15:00:40,432 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 15:00:40,432 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 15:00:40,433 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 15:00:40,436 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 16:00:02.090831: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 16:00:02.103486: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 16:00:02.116515: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 16:00:02.121009: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 16:00:02.132445: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 16:00:05,664 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761753605.755854   45728 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761753605.757419   45728 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761753605.757610   45728 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 16:00:05,757 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 16:00:05,811 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 16:00:05,829 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 16:00:05,829 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 16:00:05,830 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 16:00:05,831 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 16:00:05,831 [INFO] Downloading local price data for 1 tickers...
2025-10-29 16:00:05,836 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 16:00:05,836 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 16:00:05,841 [INFO] Disconnecting
2025-10-29 16:00:05,841 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 16:00:05,841 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 16:00:05,841 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 16:00:05,842 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 16:00:05,842 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 16:00:05,842 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 16:00:05,844 [INFO] Disconnecting
2025-10-29 16:00:05,844 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 16:00:05,844 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 16:00:05,845 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 16:00:05,845 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 16:00:05,845 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 16:00:05,845 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 16:00:05,847 [INFO] Disconnecting
2025-10-29 16:00:05,847 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 16:00:05,848 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 16:00:05,848 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 16:00:05,848 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 16:00:05,848 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 16:00:05,848 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 16:00:05,850 [INFO] Disconnecting
2025-10-29 16:00:05,850 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 16:00:05,851 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 16:00:05,851 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 16:00:05,851 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 16:00:05,851 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 16:00:05,851 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 16:00:05,853 [INFO] Disconnecting
2025-10-29 16:00:05,854 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 16:00:05,854 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 16:00:05,854 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 16:00:05,854 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 16:00:05,854 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 16:00:05,855 [WARNING] Failed to create historical_data.csv.
2025-10-29 16:00:05,856 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 16:00:05,856 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 16:00:05,858 [INFO] Disconnecting
2025-10-29 16:00:05,859 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 16:00:05,859 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 16:00:05,861 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 16:00:05,861 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 16:00:11,077 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 16:00:11,077 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 16:00:11,081 [INFO] Disconnecting
2025-10-29 16:00:11,081 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 16:00:11,081 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 16:00:11,082 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 16:00:11,083 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 16:00:16,086 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 16:00:16,087 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 16:00:16,100 [INFO] Disconnecting
2025-10-29 16:00:16,101 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 16:00:16,101 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 16:00:16,102 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 16:00:16,104 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 16:00:16,104 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 16:00:16,105 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 16:00:16,105 [INFO] Disconnecting
2025-10-29 16:00:16,110 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 16:00:16,110 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 16:00:16,111 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 16:00:16,111 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 16:00:21,117 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 16:00:21,117 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 16:00:21,118 [INFO] Disconnecting
2025-10-29 16:00:21,118 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 16:00:21,118 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 16:00:21,119 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 16:00:21,120 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 16:00:26,093 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 16:00:26,094 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 16:00:26,095 [INFO] Disconnecting
2025-10-29 16:00:26,097 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 16:00:26,097 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 16:00:26,098 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 16:00:26,099 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 16:00:26,100 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 16:00:26,100 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 16:00:26,101 [INFO] Disconnecting
2025-10-29 16:00:26,101 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 16:00:26,102 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 16:00:26,103 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 16:00:31,103 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 16:00:31,104 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 16:00:31,105 [INFO] Disconnecting
2025-10-29 16:00:31,106 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 16:00:31,107 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 16:00:31,107 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 16:00:36,108 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 16:00:36,109 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 16:00:36,110 [INFO] Disconnecting
2025-10-29 16:00:36,110 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 16:00:36,112 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 16:00:36,114 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 16:00:36,114 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 16:00:36,114 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 16:00:36,115 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 16:00:36,117 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 17:00:02.264555: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 17:00:02.277843: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 17:00:02.291363: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 17:00:02.296090: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 17:00:02.307936: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 17:00:05,836 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761757205.933366   45794 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761757205.934782   45794 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761757205.934971   45794 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 17:00:05,935 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 17:00:05,989 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 17:00:06,008 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 17:00:06,008 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 17:00:06,009 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 17:00:06,010 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 17:00:06,010 [INFO] Downloading local price data for 1 tickers...
2025-10-29 17:00:06,015 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 17:00:06,016 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 17:00:06,020 [INFO] Disconnecting
2025-10-29 17:00:06,020 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 17:00:06,021 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 17:00:06,021 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 17:00:06,021 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 17:00:06,021 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 17:00:06,021 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 17:00:06,023 [INFO] Disconnecting
2025-10-29 17:00:06,024 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 17:00:06,024 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 17:00:06,024 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 17:00:06,024 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 17:00:06,024 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 17:00:06,025 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 17:00:06,026 [INFO] Disconnecting
2025-10-29 17:00:06,027 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 17:00:06,027 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 17:00:06,027 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 17:00:06,027 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 17:00:06,027 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 17:00:06,028 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 17:00:06,030 [INFO] Disconnecting
2025-10-29 17:00:06,030 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 17:00:06,030 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 17:00:06,030 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 17:00:06,030 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 17:00:06,031 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 17:00:06,031 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 17:00:06,033 [INFO] Disconnecting
2025-10-29 17:00:06,033 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 17:00:06,033 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 17:00:06,033 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 17:00:06,034 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 17:00:06,034 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 17:00:06,034 [WARNING] Failed to create historical_data.csv.
2025-10-29 17:00:06,035 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 17:00:06,036 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 17:00:06,038 [INFO] Disconnecting
2025-10-29 17:00:06,038 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 17:00:06,038 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 17:00:06,040 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 17:00:06,040 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 17:00:11,250 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 17:00:11,251 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 17:00:11,254 [INFO] Disconnecting
2025-10-29 17:00:11,254 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 17:00:11,254 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 17:00:11,256 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 17:00:11,256 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 17:00:16,263 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 17:00:16,263 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 17:00:16,266 [INFO] Disconnecting
2025-10-29 17:00:16,266 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 17:00:16,267 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 17:00:16,268 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 17:00:16,269 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 17:00:16,270 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 17:00:16,270 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 17:00:16,271 [INFO] Disconnecting
2025-10-29 17:00:16,271 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 17:00:16,271 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 17:00:16,272 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 17:00:16,273 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 17:00:21,222 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 17:00:21,223 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 17:00:21,223 [INFO] Disconnecting
2025-10-29 17:00:21,224 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 17:00:21,224 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 17:00:21,225 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 17:00:21,225 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 17:00:26,226 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 17:00:26,226 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 17:00:26,227 [INFO] Disconnecting
2025-10-29 17:00:26,229 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 17:00:26,229 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 17:00:26,230 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 17:00:26,231 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 17:00:26,232 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 17:00:26,232 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 17:00:26,233 [INFO] Disconnecting
2025-10-29 17:00:26,233 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 17:00:26,234 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 17:00:26,235 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 17:00:31,236 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 17:00:31,237 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 17:00:31,238 [INFO] Disconnecting
2025-10-29 17:00:31,238 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 17:00:31,240 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 17:00:31,240 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 17:00:36,240 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 17:00:36,241 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 17:00:36,242 [INFO] Disconnecting
2025-10-29 17:00:36,243 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 17:00:36,244 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 17:00:36,246 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 17:00:36,246 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 17:00:36,246 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 17:00:36,247 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 17:00:36,249 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 18:00:02.649175: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 18:00:02.860243: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 18:00:02.927744: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 18:00:02.948771: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 18:00:03.055636: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 18:00:09,734 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761760809.894467   45860 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761760809.899361   45860 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761760809.899546   45860 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 18:00:09,900 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 18:00:09,976 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 18:00:09,994 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 18:00:09,994 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 18:00:09,995 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 18:00:09,996 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 18:00:09,996 [INFO] Downloading local price data for 1 tickers...
2025-10-29 18:00:10,001 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 18:00:10,001 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 18:00:10,029 [INFO] Disconnecting
2025-10-29 18:00:10,029 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 18:00:10,029 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 18:00:10,029 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 18:00:10,030 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 18:00:10,030 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 18:00:10,030 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 18:00:10,032 [INFO] Disconnecting
2025-10-29 18:00:10,032 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 18:00:10,033 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 18:00:10,033 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 18:00:10,033 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 18:00:10,033 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 18:00:10,033 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 18:00:10,035 [INFO] Disconnecting
2025-10-29 18:00:10,035 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 18:00:10,036 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 18:00:10,036 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 18:00:10,036 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 18:00:10,036 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 18:00:10,037 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 18:00:10,039 [INFO] Disconnecting
2025-10-29 18:00:10,039 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 18:00:10,039 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 18:00:10,039 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 18:00:10,039 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 18:00:10,040 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 18:00:10,040 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 18:00:10,042 [INFO] Disconnecting
2025-10-29 18:00:10,042 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 18:00:10,042 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 18:00:10,042 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 18:00:10,043 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 18:00:10,043 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 18:00:10,043 [WARNING] Failed to create historical_data.csv.
2025-10-29 18:00:10,044 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 18:00:10,044 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 18:00:10,046 [INFO] Disconnecting
2025-10-29 18:00:10,046 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 18:00:10,047 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 18:00:10,051 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 18:00:10,051 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 18:00:15,268 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 18:00:15,269 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 18:00:15,272 [INFO] Disconnecting
2025-10-29 18:00:15,273 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 18:00:15,273 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 18:00:15,274 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 18:00:15,275 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 18:00:20,262 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 18:00:20,263 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 18:00:20,267 [INFO] Disconnecting
2025-10-29 18:00:20,267 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 18:00:20,267 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 18:00:20,268 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 18:00:20,271 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 18:00:20,271 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 18:00:20,272 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 18:00:20,272 [INFO] Disconnecting
2025-10-29 18:00:20,272 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 18:00:20,273 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 18:00:20,274 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 18:00:20,274 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 18:00:25,275 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 18:00:25,276 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 18:00:25,276 [INFO] Disconnecting
2025-10-29 18:00:25,278 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 18:00:25,278 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 18:00:25,280 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 18:00:25,280 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 18:00:30,283 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 18:00:30,283 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 18:00:30,284 [INFO] Disconnecting
2025-10-29 18:00:30,286 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 18:00:30,286 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 18:00:30,288 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 18:00:30,289 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 18:00:30,289 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 18:00:30,290 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 18:00:30,291 [INFO] Disconnecting
2025-10-29 18:00:30,291 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 18:00:30,292 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 18:00:30,293 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 18:00:35,297 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 18:00:35,298 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 18:00:35,299 [INFO] Disconnecting
2025-10-29 18:00:35,301 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 18:00:35,303 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 18:00:35,303 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 18:00:40,305 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 18:00:40,306 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 18:00:40,307 [INFO] Disconnecting
2025-10-29 18:00:40,308 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 18:00:40,310 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 18:00:40,311 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 18:00:40,311 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 18:00:40,312 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 18:00:40,312 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 18:00:40,315 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 19:00:02.502752: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 19:00:02.673274: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 19:00:02.734195: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 19:00:02.754666: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 19:00:02.862705: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 19:00:09,151 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761764409.288298   45926 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761764409.293465   45926 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761764409.293652   45926 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 19:00:09,294 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 19:00:09,364 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 19:00:09,381 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 19:00:09,382 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 19:00:09,383 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 19:00:09,383 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 19:00:09,383 [INFO] Downloading local price data for 1 tickers...
2025-10-29 19:00:09,388 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 19:00:09,389 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 19:00:09,394 [INFO] Disconnecting
2025-10-29 19:00:09,394 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 19:00:09,394 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 19:00:09,395 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 19:00:09,395 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 19:00:09,395 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 19:00:09,395 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 19:00:09,397 [INFO] Disconnecting
2025-10-29 19:00:09,397 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 19:00:09,398 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 19:00:09,398 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 19:00:09,398 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 19:00:09,398 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 19:00:09,398 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 19:00:09,400 [INFO] Disconnecting
2025-10-29 19:00:09,401 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 19:00:09,401 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 19:00:09,401 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 19:00:09,401 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 19:00:09,401 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 19:00:09,402 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 19:00:09,403 [INFO] Disconnecting
2025-10-29 19:00:09,404 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 19:00:09,404 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 19:00:09,404 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 19:00:09,404 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 19:00:09,405 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 19:00:09,405 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 19:00:09,407 [INFO] Disconnecting
2025-10-29 19:00:09,407 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 19:00:09,407 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 19:00:09,407 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 19:00:09,407 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 19:00:09,408 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 19:00:09,408 [WARNING] Failed to create historical_data.csv.
2025-10-29 19:00:09,409 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 19:00:09,409 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 19:00:09,411 [INFO] Disconnecting
2025-10-29 19:00:09,411 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 19:00:09,411 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 19:00:09,416 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 19:00:09,416 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 19:00:14,661 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 19:00:14,661 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 19:00:14,665 [INFO] Disconnecting
2025-10-29 19:00:14,666 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 19:00:14,666 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 19:00:14,667 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 19:00:14,668 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 19:00:19,647 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 19:00:19,648 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 19:00:19,651 [INFO] Disconnecting
2025-10-29 19:00:19,651 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 19:00:19,651 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 19:00:19,653 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 19:00:19,657 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 19:00:19,658 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 19:00:19,658 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 19:00:19,659 [INFO] Disconnecting
2025-10-29 19:00:19,659 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 19:00:19,659 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 19:00:19,660 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 19:00:19,661 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 19:00:24,662 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 19:00:24,663 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 19:00:24,663 [INFO] Disconnecting
2025-10-29 19:00:24,665 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 19:00:24,665 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 19:00:24,666 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 19:00:24,667 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 19:00:29,668 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 19:00:29,668 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 19:00:29,669 [INFO] Disconnecting
2025-10-29 19:00:29,670 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 19:00:29,670 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 19:00:29,671 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 19:00:29,673 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 19:00:29,673 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 19:00:29,674 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 19:00:29,675 [INFO] Disconnecting
2025-10-29 19:00:29,675 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 19:00:29,676 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 19:00:29,677 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 19:00:34,678 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 19:00:34,678 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 19:00:34,680 [INFO] Disconnecting
2025-10-29 19:00:34,681 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 19:00:34,683 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 19:00:34,683 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 19:00:39,685 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 19:00:39,686 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 19:00:39,688 [INFO] Disconnecting
2025-10-29 19:00:39,689 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 19:00:39,690 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 19:00:39,692 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 19:00:39,692 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 19:00:39,693 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 19:00:39,693 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 19:00:39,695 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 20:00:02.170959: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 20:00:02.345076: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 20:00:02.407488: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 20:00:02.427863: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 20:00:02.540419: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 20:00:08,732 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761768008.869046   45995 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761768008.873903   45995 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761768008.874105   45995 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 20:00:08,874 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 20:00:08,944 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 20:00:08,961 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 20:00:08,962 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 20:00:08,963 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 20:00:08,963 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 20:00:08,963 [INFO] Downloading local price data for 1 tickers...
2025-10-29 20:00:08,968 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 20:00:08,969 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 20:00:08,974 [INFO] Disconnecting
2025-10-29 20:00:08,974 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 20:00:08,974 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 20:00:08,974 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 20:00:08,974 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 20:00:08,975 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 20:00:08,975 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 20:00:08,977 [INFO] Disconnecting
2025-10-29 20:00:08,977 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 20:00:08,977 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 20:00:08,977 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 20:00:08,977 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 20:00:08,978 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 20:00:08,978 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 20:00:08,980 [INFO] Disconnecting
2025-10-29 20:00:08,980 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 20:00:08,980 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 20:00:08,980 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 20:00:08,980 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 20:00:08,981 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 20:00:08,981 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 20:00:08,983 [INFO] Disconnecting
2025-10-29 20:00:08,983 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 20:00:08,983 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 20:00:08,983 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 20:00:08,983 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 20:00:08,984 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 20:00:08,984 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 20:00:08,986 [INFO] Disconnecting
2025-10-29 20:00:08,986 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 20:00:08,986 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 20:00:08,986 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 20:00:08,986 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 20:00:08,987 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 20:00:08,987 [WARNING] Failed to create historical_data.csv.
2025-10-29 20:00:08,988 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 20:00:08,988 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 20:00:08,990 [INFO] Disconnecting
2025-10-29 20:00:08,990 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 20:00:08,991 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 20:00:08,995 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 20:00:08,995 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 20:00:14,186 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 20:00:14,187 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 20:00:14,190 [INFO] Disconnecting
2025-10-29 20:00:14,190 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 20:00:14,191 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 20:00:14,192 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 20:00:14,192 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 20:00:19,193 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 20:00:19,194 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 20:00:19,197 [INFO] Disconnecting
2025-10-29 20:00:19,197 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 20:00:19,197 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 20:00:19,199 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 20:00:19,201 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 20:00:19,201 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 20:00:19,202 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 20:00:19,202 [INFO] Disconnecting
2025-10-29 20:00:19,202 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 20:00:19,203 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 20:00:19,204 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 20:00:19,204 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 20:00:24,206 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 20:00:24,207 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 20:00:24,208 [INFO] Disconnecting
2025-10-29 20:00:24,208 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 20:00:24,208 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 20:00:24,210 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 20:00:24,210 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 20:00:29,212 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 20:00:29,212 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 20:00:29,213 [INFO] Disconnecting
2025-10-29 20:00:29,213 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 20:00:29,213 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 20:00:29,215 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 20:00:29,216 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 20:00:29,216 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 20:00:29,217 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 20:00:29,220 [INFO] Disconnecting
2025-10-29 20:00:29,220 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 20:00:29,221 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 20:00:29,222 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 20:00:34,222 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 20:00:34,223 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 20:00:34,224 [INFO] Disconnecting
2025-10-29 20:00:34,224 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 20:00:34,226 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 20:00:34,226 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 20:00:39,227 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 20:00:39,227 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 20:00:39,229 [INFO] Disconnecting
2025-10-29 20:00:39,230 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 20:00:39,231 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 20:00:39,232 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 20:00:39,233 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 20:00:39,233 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 20:00:39,233 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 20:00:39,236 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 21:00:02.253283: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 21:00:02.419436: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 21:00:02.479032: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 21:00:02.498216: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 21:00:02.603442: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 21:00:08,704 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761771608.838794   46061 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761771608.843592   46061 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761771608.843779   46061 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 21:00:08,844 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 21:00:08,913 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 21:00:08,931 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 21:00:08,932 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 21:00:08,933 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 21:00:08,933 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 21:00:08,933 [INFO] Downloading local price data for 1 tickers...
2025-10-29 21:00:08,939 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 21:00:08,939 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 21:00:08,944 [INFO] Disconnecting
2025-10-29 21:00:08,944 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 21:00:08,945 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 21:00:08,945 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 21:00:08,945 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 21:00:08,945 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 21:00:08,945 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 21:00:08,947 [INFO] Disconnecting
2025-10-29 21:00:08,948 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 21:00:08,948 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 21:00:08,948 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 21:00:08,948 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 21:00:08,948 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 21:00:08,949 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 21:00:08,950 [INFO] Disconnecting
2025-10-29 21:00:08,951 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 21:00:08,951 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 21:00:08,951 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 21:00:08,951 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 21:00:08,951 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 21:00:08,952 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 21:00:08,954 [INFO] Disconnecting
2025-10-29 21:00:08,954 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 21:00:08,954 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 21:00:08,954 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 21:00:08,954 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 21:00:08,954 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 21:00:08,955 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 21:00:08,957 [INFO] Disconnecting
2025-10-29 21:00:08,957 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 21:00:08,957 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 21:00:08,957 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 21:00:08,957 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 21:00:08,957 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 21:00:08,958 [WARNING] Failed to create historical_data.csv.
2025-10-29 21:00:08,959 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 21:00:08,959 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 21:00:08,961 [INFO] Disconnecting
2025-10-29 21:00:08,962 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 21:00:08,962 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 21:00:08,966 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 21:00:08,966 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 21:00:14,133 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 21:00:14,134 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 21:00:14,137 [INFO] Disconnecting
2025-10-29 21:00:14,137 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 21:00:14,137 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 21:00:14,139 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 21:00:14,139 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 21:00:19,140 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 21:00:19,141 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 21:00:19,144 [INFO] Disconnecting
2025-10-29 21:00:19,144 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 21:00:19,144 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 21:00:19,146 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 21:00:19,148 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 21:00:19,149 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 21:00:19,149 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 21:00:19,149 [INFO] Disconnecting
2025-10-29 21:00:19,150 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 21:00:19,150 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 21:00:19,151 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 21:00:19,151 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 21:00:24,153 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 21:00:24,153 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 21:00:24,154 [INFO] Disconnecting
2025-10-29 21:00:24,156 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 21:00:24,156 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 21:00:24,157 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 21:00:24,158 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 21:00:29,160 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 21:00:29,161 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 21:00:29,162 [INFO] Disconnecting
2025-10-29 21:00:29,162 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 21:00:29,162 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 21:00:29,164 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 21:00:29,165 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 21:00:29,166 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 21:00:29,166 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 21:00:29,167 [INFO] Disconnecting
2025-10-29 21:00:29,167 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 21:00:29,169 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 21:00:29,169 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 21:00:34,170 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 21:00:34,170 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 21:00:34,172 [INFO] Disconnecting
2025-10-29 21:00:34,172 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 21:00:34,173 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 21:00:34,174 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 21:00:39,174 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 21:00:39,175 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 21:00:39,176 [INFO] Disconnecting
2025-10-29 21:00:39,178 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 21:00:39,179 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 21:00:39,180 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 21:00:39,181 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 21:00:39,181 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 21:00:39,182 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 21:00:39,184 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 22:00:02.577340: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 22:00:02.749984: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 22:00:02.812171: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 22:00:02.832232: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 22:00:02.954484: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 22:00:09,071 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761775209.205372   46127 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761775209.210172   46127 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761775209.210356   46127 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 22:00:09,210 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 22:00:09,281 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 22:00:09,299 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 22:00:09,299 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 22:00:09,300 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 22:00:09,300 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 22:00:09,301 [INFO] Downloading local price data for 1 tickers...
2025-10-29 22:00:09,306 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 22:00:09,306 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 22:00:09,311 [INFO] Disconnecting
2025-10-29 22:00:09,311 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 22:00:09,311 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 22:00:09,312 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 22:00:09,312 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 22:00:09,312 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 22:00:09,312 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 22:00:09,314 [INFO] Disconnecting
2025-10-29 22:00:09,314 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 22:00:09,315 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 22:00:09,315 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 22:00:09,315 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 22:00:09,315 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 22:00:09,315 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 22:00:09,317 [INFO] Disconnecting
2025-10-29 22:00:09,318 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 22:00:09,318 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 22:00:09,318 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 22:00:09,318 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 22:00:09,318 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 22:00:09,318 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 22:00:09,320 [INFO] Disconnecting
2025-10-29 22:00:09,320 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 22:00:09,321 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 22:00:09,321 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 22:00:09,321 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 22:00:09,321 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 22:00:09,321 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 22:00:09,323 [INFO] Disconnecting
2025-10-29 22:00:09,323 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 22:00:09,323 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 22:00:09,324 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 22:00:09,324 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 22:00:09,324 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 22:00:09,324 [WARNING] Failed to create historical_data.csv.
2025-10-29 22:00:09,325 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 22:00:09,326 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 22:00:09,328 [INFO] Disconnecting
2025-10-29 22:00:09,328 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 22:00:09,328 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 22:00:09,332 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 22:00:09,333 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 22:00:14,548 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 22:00:14,548 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 22:00:14,552 [INFO] Disconnecting
2025-10-29 22:00:14,552 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 22:00:14,552 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 22:00:14,554 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 22:00:14,554 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 22:00:19,556 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 22:00:19,557 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 22:00:19,560 [INFO] Disconnecting
2025-10-29 22:00:19,560 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 22:00:19,561 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 22:00:19,562 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 22:00:19,566 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 22:00:19,567 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 22:00:19,567 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 22:00:19,568 [INFO] Disconnecting
2025-10-29 22:00:19,568 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 22:00:19,568 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 22:00:19,569 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 22:00:19,570 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 22:00:24,570 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 22:00:24,571 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 22:00:24,571 [INFO] Disconnecting
2025-10-29 22:00:24,572 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 22:00:24,572 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 22:00:24,573 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 22:00:24,574 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 22:00:29,576 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 22:00:29,577 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 22:00:29,577 [INFO] Disconnecting
2025-10-29 22:00:29,579 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 22:00:29,579 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 22:00:29,581 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 22:00:29,582 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 22:00:29,583 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 22:00:29,583 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 22:00:29,584 [INFO] Disconnecting
2025-10-29 22:00:29,584 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 22:00:29,585 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 22:00:29,586 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 22:00:34,587 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 22:00:34,588 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 22:00:34,589 [INFO] Disconnecting
2025-10-29 22:00:34,589 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 22:00:34,590 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 22:00:34,591 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 22:00:39,570 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 22:00:39,571 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 22:00:39,572 [INFO] Disconnecting
2025-10-29 22:00:39,572 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 22:00:39,573 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 22:00:39,574 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 22:00:39,575 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 22:00:39,575 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 22:00:39,575 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 22:00:39,578 [INFO] ✅ Cleaned up resources on exit.
2025-10-29 23:00:03.030737: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-29 23:00:03.217491: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-29 23:00:03.283031: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-29 23:00:03.304298: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-29 23:00:03.416591: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-29 23:00:10,133 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761778810.255067   46279 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761778810.261592   46279 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761778810.261809   46279 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-29 23:00:10,262 [INFO] TensorFlow detected 1 GPU(s).
2025-10-29 23:00:10,326 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-29 23:00:10,340 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-29 23:00:10,340 [INFO] Script initialization completed, proceeding to main loop...
2025-10-29 23:00:10,341 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-29 23:00:10,342 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-29 23:00:10,342 [INFO] Downloading local price data for 1 tickers...
2025-10-29 23:00:10,346 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 23:00:10,346 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-29 23:00:10,351 [INFO] Disconnecting
2025-10-29 23:00:10,351 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 23:00:10,351 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 23:00:10,351 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 23:00:10,352 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 23:00:10,352 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 23:00:10,352 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-29 23:00:10,354 [INFO] Disconnecting
2025-10-29 23:00:10,354 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 23:00:10,355 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 23:00:10,355 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 23:00:10,355 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 23:00:10,355 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 23:00:10,355 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-29 23:00:10,357 [INFO] Disconnecting
2025-10-29 23:00:10,358 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 23:00:10,358 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 23:00:10,358 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 23:00:10,358 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 23:00:10,358 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 23:00:10,359 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-29 23:00:10,361 [INFO] Disconnecting
2025-10-29 23:00:10,361 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 23:00:10,361 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 23:00:10,361 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 23:00:10,361 [INFO] Retrying IBKR connection with a different clientId...
2025-10-29 23:00:10,361 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 23:00:10,362 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-29 23:00:10,363 [INFO] Disconnecting
2025-10-29 23:00:10,364 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 23:00:10,364 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 23:00:10,364 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-29 23:00:10,364 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-29 23:00:10,364 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-29 23:00:10,365 [WARNING] Failed to create historical_data.csv.
2025-10-29 23:00:10,366 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-29 23:00:10,366 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-29 23:00:10,368 [INFO] Disconnecting
2025-10-29 23:00:10,368 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 23:00:10,368 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 23:00:10,373 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 23:00:10,373 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 23:00:15,589 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-29 23:00:15,590 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-29 23:00:15,593 [INFO] Disconnecting
2025-10-29 23:00:15,593 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 23:00:15,593 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 23:00:15,594 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 23:00:15,595 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-29 23:00:20,596 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-29 23:00:20,596 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-29 23:00:20,600 [INFO] Disconnecting
2025-10-29 23:00:20,600 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-29 23:00:20,600 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 23:00:20,602 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 23:00:20,605 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-29 23:00:20,605 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-29 23:00:20,606 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-29 23:00:20,606 [INFO] Disconnecting
2025-10-29 23:00:20,606 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 23:00:20,607 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 23:00:20,607 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 23:00:20,608 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 23:00:25,610 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-29 23:00:25,611 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-29 23:00:25,611 [INFO] Disconnecting
2025-10-29 23:00:25,612 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 23:00:25,612 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 23:00:25,613 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 23:00:25,613 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 23:00:30,616 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-29 23:00:30,617 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-29 23:00:30,617 [INFO] Disconnecting
2025-10-29 23:00:30,617 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-29 23:00:30,617 [ERROR] Make sure API port on TWS/IBG is open
2025-10-29 23:00:30,618 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 23:00:30,620 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 23:00:30,620 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-29 23:00:30,620 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-29 23:00:30,624 [INFO] Disconnecting
2025-10-29 23:00:30,624 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 23:00:30,625 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 23:00:30,626 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 23:00:35,620 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-29 23:00:35,621 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-29 23:00:35,622 [INFO] Disconnecting
2025-10-29 23:00:35,624 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 23:00:35,625 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 23:00:35,625 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-29 23:00:40,626 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-29 23:00:40,627 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-29 23:00:40,627 [INFO] Disconnecting
2025-10-29 23:00:40,629 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-29 23:00:40,630 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 23:00:40,631 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-29 23:00:40,631 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-29 23:00:40,632 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-29 23:00:40,632 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-29 23:00:40,633 [INFO] ✅ Cleaned up resources on exit.
2025-10-30 00:00:02.855476: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-30 00:00:03.028417: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-30 00:00:03.092959: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-30 00:00:03.112813: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-30 00:00:03.219831: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-30 00:00:09,451 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761782409.587694   46399 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761782409.592389   46399 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761782409.592574   46399 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-30 00:00:09,593 [INFO] TensorFlow detected 1 GPU(s).
2025-10-30 00:00:09,664 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-30 00:00:09,683 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-30 00:00:09,683 [INFO] Script initialization completed, proceeding to main loop...
2025-10-30 00:00:09,684 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-30 00:00:09,685 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-30 00:00:09,685 [INFO] Downloading local price data for 1 tickers...
2025-10-30 00:00:09,690 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-30 00:00:09,690 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-30 00:00:09,695 [INFO] Disconnecting
2025-10-30 00:00:09,695 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 00:00:09,695 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 00:00:09,696 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 00:00:09,696 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 00:00:09,696 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-30 00:00:09,696 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-30 00:00:09,698 [INFO] Disconnecting
2025-10-30 00:00:09,698 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 00:00:09,698 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 00:00:09,699 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 00:00:09,699 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 00:00:09,699 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-30 00:00:09,699 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-30 00:00:09,701 [INFO] Disconnecting
2025-10-30 00:00:09,701 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 00:00:09,701 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 00:00:09,702 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 00:00:09,702 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 00:00:09,702 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-30 00:00:09,702 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-30 00:00:09,704 [INFO] Disconnecting
2025-10-30 00:00:09,704 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 00:00:09,705 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 00:00:09,705 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 00:00:09,705 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 00:00:09,705 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-30 00:00:09,705 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-30 00:00:09,707 [INFO] Disconnecting
2025-10-30 00:00:09,707 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 00:00:09,708 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 00:00:09,708 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 00:00:09,708 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-30 00:00:09,708 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-30 00:00:09,708 [WARNING] Failed to create historical_data.csv.
2025-10-30 00:00:09,710 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-30 00:00:09,710 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-30 00:00:09,712 [INFO] Disconnecting
2025-10-30 00:00:09,712 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 00:00:09,712 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 00:00:09,716 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 00:00:09,717 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-30 00:00:14,932 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-30 00:00:14,933 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-30 00:00:14,937 [INFO] Disconnecting
2025-10-30 00:00:14,937 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 00:00:14,937 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 00:00:14,938 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 00:00:14,939 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-30 00:00:19,940 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-30 00:00:19,941 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-30 00:00:19,945 [INFO] Disconnecting
2025-10-30 00:00:19,945 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 00:00:19,945 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 00:00:19,947 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 00:00:19,951 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 00:00:19,951 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-30 00:00:19,952 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-30 00:00:19,952 [INFO] Disconnecting
2025-10-30 00:00:19,952 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 00:00:19,953 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 00:00:19,954 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 00:00:19,954 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 00:00:24,955 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-30 00:00:24,955 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-30 00:00:24,956 [INFO] Disconnecting
2025-10-30 00:00:24,958 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 00:00:24,958 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 00:00:24,960 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 00:00:24,960 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 00:00:29,961 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-30 00:00:29,962 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-30 00:00:29,963 [INFO] Disconnecting
2025-10-30 00:00:29,964 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 00:00:29,964 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 00:00:29,965 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 00:00:29,967 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 00:00:29,967 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-30 00:00:29,968 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-30 00:00:29,969 [INFO] Disconnecting
2025-10-30 00:00:29,969 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 00:00:29,970 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 00:00:29,970 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 00:00:34,942 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-30 00:00:34,943 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-30 00:00:34,944 [INFO] Disconnecting
2025-10-30 00:00:34,944 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 00:00:34,946 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 00:00:34,946 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 00:00:39,946 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-30 00:00:39,947 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-30 00:00:39,949 [INFO] Disconnecting
2025-10-30 00:00:39,950 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 00:00:39,952 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 00:00:39,953 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 00:00:39,954 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-30 00:00:39,954 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-30 00:00:39,954 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-30 00:00:39,957 [INFO] ✅ Cleaned up resources on exit.
2025-10-30 01:00:02.888864: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-30 01:00:03.062672: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-30 01:00:03.125429: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-30 01:00:03.145247: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-30 01:00:03.262838: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-30 01:00:09,421 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761786009.548011   46465 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761786009.552914   46465 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761786009.553130   46465 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-30 01:00:09,554 [INFO] TensorFlow detected 1 GPU(s).
2025-10-30 01:00:09,625 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-30 01:00:09,642 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-30 01:00:09,642 [INFO] Script initialization completed, proceeding to main loop...
2025-10-30 01:00:09,643 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-30 01:00:09,644 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-30 01:00:09,644 [INFO] Downloading local price data for 1 tickers...
2025-10-30 01:00:09,649 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-30 01:00:09,649 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-30 01:00:09,654 [INFO] Disconnecting
2025-10-30 01:00:09,654 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 01:00:09,655 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 01:00:09,655 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 01:00:09,655 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 01:00:09,655 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-30 01:00:09,655 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-30 01:00:09,657 [INFO] Disconnecting
2025-10-30 01:00:09,658 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 01:00:09,658 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 01:00:09,658 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 01:00:09,658 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 01:00:09,658 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-30 01:00:09,659 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-30 01:00:09,661 [INFO] Disconnecting
2025-10-30 01:00:09,661 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 01:00:09,661 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 01:00:09,661 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 01:00:09,661 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 01:00:09,662 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-30 01:00:09,662 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-30 01:00:09,664 [INFO] Disconnecting
2025-10-30 01:00:09,664 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 01:00:09,664 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 01:00:09,664 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 01:00:09,664 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 01:00:09,665 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-30 01:00:09,665 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-30 01:00:09,667 [INFO] Disconnecting
2025-10-30 01:00:09,667 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 01:00:09,667 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 01:00:09,667 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 01:00:09,667 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-30 01:00:09,668 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-30 01:00:09,668 [WARNING] Failed to create historical_data.csv.
2025-10-30 01:00:09,669 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-30 01:00:09,669 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-30 01:00:09,671 [INFO] Disconnecting
2025-10-30 01:00:09,671 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 01:00:09,671 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 01:00:09,676 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 01:00:09,676 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-30 01:00:14,895 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-30 01:00:14,896 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-30 01:00:14,899 [INFO] Disconnecting
2025-10-30 01:00:14,899 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 01:00:14,899 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 01:00:14,901 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 01:00:14,901 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-30 01:00:19,907 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-30 01:00:19,909 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-30 01:00:19,912 [INFO] Disconnecting
2025-10-30 01:00:19,912 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 01:00:19,912 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 01:00:19,914 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 01:00:19,918 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 01:00:19,919 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-30 01:00:19,919 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-30 01:00:19,920 [INFO] Disconnecting
2025-10-30 01:00:19,920 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 01:00:19,920 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 01:00:19,921 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 01:00:19,922 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 01:00:24,924 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-30 01:00:24,925 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-30 01:00:24,926 [INFO] Disconnecting
2025-10-30 01:00:24,926 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 01:00:24,926 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 01:00:24,927 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 01:00:24,928 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 01:00:29,899 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-30 01:00:29,900 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-30 01:00:29,900 [INFO] Disconnecting
2025-10-30 01:00:29,901 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 01:00:29,901 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 01:00:29,902 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 01:00:29,904 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 01:00:29,904 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-30 01:00:29,905 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-30 01:00:29,906 [INFO] Disconnecting
2025-10-30 01:00:29,907 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 01:00:29,908 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 01:00:29,908 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 01:00:34,909 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-30 01:00:34,910 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-30 01:00:34,911 [INFO] Disconnecting
2025-10-30 01:00:34,911 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 01:00:34,912 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 01:00:34,913 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 01:00:39,914 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-30 01:00:39,914 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-30 01:00:39,916 [INFO] Disconnecting
2025-10-30 01:00:39,916 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 01:00:39,917 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 01:00:39,919 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 01:00:39,919 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-30 01:00:39,919 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-30 01:00:39,920 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-30 01:00:39,923 [INFO] ✅ Cleaned up resources on exit.
2025-10-30 02:00:02.268511: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-30 02:00:02.440417: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-30 02:00:02.502922: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-30 02:00:02.522648: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-30 02:00:02.637701: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-30 02:00:08,946 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761789609.082590   46531 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761789609.087377   46531 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761789609.087591   46531 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-30 02:00:09,088 [INFO] TensorFlow detected 1 GPU(s).
2025-10-30 02:00:09,158 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-30 02:00:09,176 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-30 02:00:09,176 [INFO] Script initialization completed, proceeding to main loop...
2025-10-30 02:00:09,177 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-30 02:00:09,177 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-30 02:00:09,178 [INFO] Downloading local price data for 1 tickers...
2025-10-30 02:00:09,183 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-30 02:00:09,183 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-30 02:00:09,188 [INFO] Disconnecting
2025-10-30 02:00:09,188 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 02:00:09,188 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 02:00:09,188 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 02:00:09,189 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 02:00:09,189 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-30 02:00:09,189 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-30 02:00:09,191 [INFO] Disconnecting
2025-10-30 02:00:09,191 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 02:00:09,191 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 02:00:09,192 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 02:00:09,192 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 02:00:09,192 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-30 02:00:09,192 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-30 02:00:09,194 [INFO] Disconnecting
2025-10-30 02:00:09,194 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 02:00:09,195 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 02:00:09,195 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 02:00:09,195 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 02:00:09,195 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-30 02:00:09,196 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-30 02:00:09,197 [INFO] Disconnecting
2025-10-30 02:00:09,198 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 02:00:09,198 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 02:00:09,198 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 02:00:09,198 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 02:00:09,198 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-30 02:00:09,198 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-30 02:00:09,200 [INFO] Disconnecting
2025-10-30 02:00:09,201 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 02:00:09,201 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 02:00:09,201 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 02:00:09,201 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-30 02:00:09,201 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-30 02:00:09,202 [WARNING] Failed to create historical_data.csv.
2025-10-30 02:00:09,203 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-30 02:00:09,203 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-30 02:00:09,205 [INFO] Disconnecting
2025-10-30 02:00:09,205 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 02:00:09,206 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 02:00:09,210 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 02:00:09,210 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-30 02:00:14,417 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-30 02:00:14,418 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-30 02:00:14,421 [INFO] Disconnecting
2025-10-30 02:00:14,421 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 02:00:14,421 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 02:00:14,423 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 02:00:14,423 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-30 02:00:19,426 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-30 02:00:19,427 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-30 02:00:19,431 [INFO] Disconnecting
2025-10-30 02:00:19,431 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 02:00:19,431 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 02:00:19,433 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 02:00:19,436 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 02:00:19,437 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-30 02:00:19,437 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-30 02:00:19,438 [INFO] Disconnecting
2025-10-30 02:00:19,438 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 02:00:19,438 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 02:00:19,439 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 02:00:19,440 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 02:00:24,440 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-30 02:00:24,441 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-30 02:00:24,442 [INFO] Disconnecting
2025-10-30 02:00:24,445 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 02:00:24,445 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 02:00:24,446 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 02:00:24,446 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 02:00:29,427 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-30 02:00:29,428 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-30 02:00:29,429 [INFO] Disconnecting
2025-10-30 02:00:29,429 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 02:00:29,429 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 02:00:29,430 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 02:00:29,432 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 02:00:29,432 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-30 02:00:29,433 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-30 02:00:29,434 [INFO] Disconnecting
2025-10-30 02:00:29,434 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 02:00:29,435 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 02:00:29,436 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 02:00:34,436 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-30 02:00:34,437 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-30 02:00:34,438 [INFO] Disconnecting
2025-10-30 02:00:34,438 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 02:00:34,440 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 02:00:34,440 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 02:00:39,441 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-30 02:00:39,443 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-30 02:00:39,444 [INFO] Disconnecting
2025-10-30 02:00:39,445 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 02:00:39,447 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 02:00:39,448 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 02:00:39,448 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-30 02:00:39,449 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-30 02:00:39,449 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-30 02:00:39,452 [INFO] ✅ Cleaned up resources on exit.
2025-10-30 03:00:02.974155: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-30 03:00:03.138908: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-30 03:00:03.197658: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-30 03:00:03.217216: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-30 03:00:03.320622: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-30 03:00:09,556 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1761793209.695729   46597 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761793209.700557   46597 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1761793209.700771   46597 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-10-30 03:00:09,701 [INFO] TensorFlow detected 1 GPU(s).
2025-10-30 03:00:09,771 [WARNING] Alpaca API credentials not configured; skipping data fetches.
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
2025-10-30 03:00:09,788 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-30 03:00:09,789 [INFO] Script initialization completed, proceeding to main loop...
2025-10-30 03:00:09,790 [INFO] historical_data.csv not found. Generating from Alpaca data...
2025-10-30 03:00:09,790 [WARNING] tickers.txt not found. Using default ['TSLA'].
2025-10-30 03:00:09,790 [INFO] Downloading local price data for 1 tickers...
2025-10-30 03:00:09,795 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-30 03:00:09,795 [INFO] Connecting to host.docker.internal:7496 with clientId 42...
2025-10-30 03:00:09,800 [INFO] Disconnecting
2025-10-30 03:00:09,801 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 03:00:09,801 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 03:00:09,801 [ERROR] Failed to connect to IBKR using clientId 42: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 03:00:09,801 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 03:00:09,801 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-30 03:00:09,801 [INFO] Connecting to host.docker.internal:7496 with clientId 43...
2025-10-30 03:00:09,803 [INFO] Disconnecting
2025-10-30 03:00:09,803 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 03:00:09,804 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 03:00:09,804 [ERROR] Failed to connect to IBKR using clientId 43: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 03:00:09,804 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 03:00:09,804 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-30 03:00:09,804 [INFO] Connecting to host.docker.internal:7496 with clientId 44...
2025-10-30 03:00:09,806 [INFO] Disconnecting
2025-10-30 03:00:09,806 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 03:00:09,806 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 03:00:09,806 [ERROR] Failed to connect to IBKR using clientId 44: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 03:00:09,807 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 03:00:09,807 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-30 03:00:09,807 [INFO] Connecting to host.docker.internal:7496 with clientId 45...
2025-10-30 03:00:09,809 [INFO] Disconnecting
2025-10-30 03:00:09,809 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 03:00:09,809 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 03:00:09,809 [ERROR] Failed to connect to IBKR using clientId 45: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 03:00:09,809 [INFO] Retrying IBKR connection with a different clientId...
2025-10-30 03:00:09,809 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-30 03:00:09,809 [INFO] Connecting to host.docker.internal:7496 with clientId 46...
2025-10-30 03:00:09,811 [INFO] Disconnecting
2025-10-30 03:00:09,811 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 03:00:09,811 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 03:00:09,812 [ERROR] Failed to connect to IBKR using clientId 46: [Errno 111] Connect call failed ('192.168.65.254', 7496)
2025-10-30 03:00:09,812 [WARNING] Skipping 1 tickers with no downloaded price data: TSLA
2025-10-30 03:00:09,812 [ERROR] No local price files were created after attempting download; unable to continue.
2025-10-30 03:00:09,812 [WARNING] Failed to create historical_data.csv.
2025-10-30 03:00:09,813 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-30 03:00:09,813 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-30 03:00:09,815 [INFO] Disconnecting
2025-10-30 03:00:09,815 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 03:00:09,815 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 03:00:09,819 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 03:00:09,820 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-30 03:00:15,038 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-30 03:00:15,039 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-30 03:00:15,043 [INFO] Disconnecting
2025-10-30 03:00:15,043 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 03:00:15,043 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 03:00:15,044 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 03:00:15,044 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-30 03:00:20,045 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-30 03:00:20,046 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-30 03:00:20,050 [INFO] Disconnecting
2025-10-30 03:00:20,050 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 03:00:20,050 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 03:00:20,051 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 03:00:20,054 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 03:00:20,054 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-30 03:00:20,054 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-30 03:00:20,055 [INFO] Disconnecting
2025-10-30 03:00:20,055 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 03:00:20,055 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 03:00:20,056 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 03:00:20,056 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 03:00:25,057 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-30 03:00:25,058 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-30 03:00:25,059 [INFO] Disconnecting
2025-10-30 03:00:25,061 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 03:00:25,061 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 03:00:25,062 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 03:00:25,063 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 03:00:30,049 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-30 03:00:30,050 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-30 03:00:30,050 [INFO] Disconnecting
2025-10-30 03:00:30,052 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 03:00:30,052 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 03:00:30,054 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 03:00:30,055 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 03:00:30,055 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-30 03:00:30,056 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-30 03:00:30,056 [INFO] Disconnecting
2025-10-30 03:00:30,057 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 03:00:30,057 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 03:00:30,058 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 03:00:35,058 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-30 03:00:35,059 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-30 03:00:35,060 [INFO] Disconnecting
2025-10-30 03:00:35,060 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 03:00:35,062 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 03:00:35,062 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 03:00:40,063 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-30 03:00:40,063 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-30 03:00:40,064 [INFO] Disconnecting
2025-10-30 03:00:40,064 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 03:00:40,065 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 03:00:40,066 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 03:00:40,067 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-30 03:00:40,067 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-30 03:00:40,067 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-30 03:00:40,070 [INFO] ✅ Cleaned up resources on exit.
2025-10-30 13:15:08.897416: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-30 13:15:09.103369: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-30 13:15:09.177434: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-30 13:15:09.201404: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-30 13:15:09.331634: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-30 13:15:17,509 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
2025-10-30 13:15:18,521 [INFO] NVIDIA runtime not detected. Forcing TensorFlow to CPU mode before import.
2025-10-30 13:15:18.623338: E external/local_xla/xla/stream_executor/cuda/cuda_driver.cc:266] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2025-10-30 13:15:18,623 [INFO] No GPU detected. TensorFlow will run on CPU. If you expected GPU support, confirm the NVIDIA drivers, container runtime, and '--gpus all' flag (for Docker) are configured.
2025-10-30 13:15:18,768 [WARNING] Alpaca API credentials not configured; skipping data fetches.
2025-10-30 13:15:18,791 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-30 13:15:18,792 [INFO] Script initialization completed, proceeding to main loop...
2025-10-30 13:15:18,795 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-30 13:15:18,796 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-30 13:15:18,812 [INFO] Disconnecting
2025-10-30 13:15:18,813 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 13:15:18,813 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 13:15:18,819 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 13:15:18,820 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-30 13:15:23,795 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-30 13:15:23,796 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-30 13:15:23,799 [INFO] Disconnecting
2025-10-30 13:15:23,799 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 13:15:23,799 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 13:15:23,801 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 13:15:23,801 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-30 13:15:28,802 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-30 13:15:28,803 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-30 13:15:28,806 [INFO] Disconnecting
2025-10-30 13:15:28,806 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 13:15:28,807 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 13:15:28,808 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 13:15:28,811 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 13:15:28,811 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-30 13:15:28,812 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-30 13:15:28,812 [INFO] Disconnecting
2025-10-30 13:15:28,813 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 13:15:28,813 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 13:15:28,814 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 13:15:28,814 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 13:15:33,815 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-30 13:15:33,816 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-30 13:15:33,817 [INFO] Disconnecting
2025-10-30 13:15:33,817 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 13:15:33,818 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 13:15:33,819 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 13:15:33,820 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 13:15:38,820 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-30 13:15:38,821 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-30 13:15:38,822 [INFO] Disconnecting
2025-10-30 13:15:38,822 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 13:15:38,823 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 13:15:38,824 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 13:15:38,826 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 13:15:38,826 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-30 13:15:38,827 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-30 13:15:38,828 [INFO] Disconnecting
2025-10-30 13:15:38,829 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 13:15:38,830 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 13:15:38,831 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 13:15:43,832 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-30 13:15:43,832 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-30 13:15:43,833 [INFO] Disconnecting
2025-10-30 13:15:43,834 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 13:15:43,835 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 13:15:43,835 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 13:15:48,837 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-30 13:15:48,838 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-30 13:15:48,839 [INFO] Disconnecting
2025-10-30 13:15:48,839 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 13:15:48,840 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 13:15:48,842 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 13:15:48,842 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-30 13:15:48,843 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-30 13:15:48,843 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-30 13:15:48,845 [INFO] ✅ Cleaned up resources on exit.
2025-10-30 14:25:25.606583: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-30 14:25:25.820398: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-30 14:25:25.897148: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-30 14:25:25.921656: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-30 14:25:26.057943: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-30 14:25:33,757 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
2025-10-30 14:25:34,769 [INFO] NVIDIA runtime not detected. Forcing TensorFlow to CPU mode before import.
2025-10-30 14:25:34.900864: E external/local_xla/xla/stream_executor/cuda/cuda_driver.cc:266] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2025-10-30 14:25:34,901 [INFO] No GPU detected. TensorFlow will run on CPU. If you expected GPU support, confirm the NVIDIA drivers, container runtime, and '--gpus all' flag (for Docker) are configured.
2025-10-30 14:25:35,016 [WARNING] Alpaca API credentials not configured; skipping data fetches.
2025-10-30 14:25:35,036 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-30 14:25:35,037 [INFO] Script initialization completed, proceeding to main loop...
2025-10-30 14:25:35,040 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-30 14:25:35,040 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-30 14:25:35,053 [INFO] Disconnecting
2025-10-30 14:25:35,054 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 14:25:35,054 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 14:25:35,059 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 14:25:35,059 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-30 14:25:40,062 [INFO] Attempting connection with clientId=101 to host.docker.internal:7496...
2025-10-30 14:25:40,063 [INFO] Connecting to host.docker.internal:7496 with clientId 101...
2025-10-30 14:25:40,067 [INFO] Disconnecting
2025-10-30 14:25:40,068 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 14:25:40,068 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 14:25:40,070 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 14:25:40,070 [WARNING] [Errno 111] Connect call failed ('192.168.65.254', 7496), retrying in 5 seconds...
2025-10-30 14:25:45,071 [INFO] Attempting connection with clientId=102 to host.docker.internal:7496...
2025-10-30 14:25:45,071 [INFO] Connecting to host.docker.internal:7496 with clientId 102...
2025-10-30 14:25:45,075 [INFO] Disconnecting
2025-10-30 14:25:45,075 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('192.168.65.254', 7496)")
2025-10-30 14:25:45,076 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 14:25:45,077 [ERROR] Connection failed: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 14:25:45,080 [ERROR] ❌ Failed to connect to IBKR at host.docker.internal:7496 after 3 attempts: [Errno 111] Connect call failed ('192.168.65.254', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('192.168.65.254', 7496)

2025-10-30 14:25:45,081 [INFO] Attempting connection with clientId=103 to 127.0.0.1:7496...
2025-10-30 14:25:45,081 [INFO] Connecting to 127.0.0.1:7496 with clientId 103...
2025-10-30 14:25:45,082 [INFO] Disconnecting
2025-10-30 14:25:45,082 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 14:25:45,083 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 14:25:45,084 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 14:25:45,084 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 14:25:50,035 [INFO] Attempting connection with clientId=104 to 127.0.0.1:7496...
2025-10-30 14:25:50,035 [INFO] Connecting to 127.0.0.1:7496 with clientId 104...
2025-10-30 14:25:50,036 [INFO] Disconnecting
2025-10-30 14:25:50,036 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 14:25:50,037 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 14:25:50,038 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 14:25:50,038 [WARNING] [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 14:25:55,039 [INFO] Attempting connection with clientId=105 to 127.0.0.1:7496...
2025-10-30 14:25:55,040 [INFO] Connecting to 127.0.0.1:7496 with clientId 105...
2025-10-30 14:25:55,040 [INFO] Disconnecting
2025-10-30 14:25:55,041 [ERROR] API connection failed: ConnectionRefusedError(111, "Connect call failed ('127.0.0.1', 7496)")
2025-10-30 14:25:55,041 [ERROR] Make sure API port on TWS/IBG is open
2025-10-30 14:25:55,042 [ERROR] Connection failed: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 14:25:55,044 [ERROR] ❌ Failed to connect to IBKR at 127.0.0.1:7496 after 3 attempts: [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1122, in create_connection
    raise exceptions[0]
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1104, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1007, in _connect_sock
    await self.sock_connect(sock, address)
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 651, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/selector_events.py", line 691, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 14:25:55,044 [INFO] Attempting connection with clientId=106 to localhost:7496...
2025-10-30 14:25:55,045 [INFO] Connecting to localhost:7496 with clientId 106...
2025-10-30 14:25:55,048 [INFO] Disconnecting
2025-10-30 14:25:55,049 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 14:25:55,050 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 14:25:55,050 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 14:26:00,051 [INFO] Attempting connection with clientId=107 to localhost:7496...
2025-10-30 14:26:00,052 [INFO] Connecting to localhost:7496 with clientId 107...
2025-10-30 14:26:00,053 [INFO] Disconnecting
2025-10-30 14:26:00,053 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 14:26:00,054 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 14:26:00,055 [WARNING] Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496), retrying in 5 seconds...
2025-10-30 14:26:05,057 [INFO] Attempting connection with clientId=108 to localhost:7496...
2025-10-30 14:26:05,058 [INFO] Connecting to localhost:7496 with clientId 108...
2025-10-30 14:26:05,059 [INFO] Disconnecting
2025-10-30 14:26:05,059 [ERROR] API connection failed: OSError("Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)")
2025-10-30 14:26:05,061 [ERROR] Connection failed: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 14:26:05,062 [ERROR] ❌ Failed to connect to IBKR at localhost:7496 after 3 attempts: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 557, in connect_ibkr
    return connect_with_retry(host)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/dist-packages/decorator.py", line 232, in fun
    return caller(func, *(extras + args), **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 73, in retry_decorator
    return __retry_internal(partial(f, *args, **kwargs), exceptions, tries, delay, max_delay, backoff, jitter,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/retry/api.py", line 33, in __retry_internal
    return f()
           ^^^
  File "/app/tsla_ai_master_final_ready.py", line 538, in _connect_single
    ib.connect(target_host, ibkr_port, clientId=client_id, timeout=30)  # Fixed: use clientId kwarg
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 279, in connect
    return self._run(self.connectAsync(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 318, in _run
    return util.run(*awaitables, timeout=self.RequestTimeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/util.py", line 341, in run
    result = loop.run_until_complete(task)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/ib.py", line 1748, in connectAsync
    await self.client.connectAsync(host, port, clientId, timeout)
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/client.py", line 211, in connectAsync
    await asyncio.wait_for(self.conn.connectAsync(host, port), timeout)
  File "/usr/lib/python3.12/asyncio/tasks.py", line 520, in wait_for
    return await fut
           ^^^^^^^^^
  File "/home/appuser/.local/lib/python3.12/site-packages/ib_insync/connection.py", line 39, in connectAsync
    self.transport, _ = await loop.create_connection(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1130, in create_connection
    raise OSError('Multiple exceptions: {}'.format(
OSError: Multiple exceptions: [Errno 111] Connect call failed ('::1', 7496, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 7496)

2025-10-30 14:26:05,062 [ERROR] ❌ All IBKR connection attempts failed. Consider using Alpaca-only mode for U.S. tickers.
2025-10-30 14:26:05,063 [ERROR] Set the IBKR_HOST environment variable to the hostname or IP of your TWS/IB Gateway machine if it is not running on this host.
2025-10-30 14:26:05,063 [ERROR] ❌ Failed to connect to IBKR. Exiting.
2025-10-30 14:26:05,065 [INFO] ✅ Cleaned up resources on exit.
2025-10-31 18:23:40.464749: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-10-31 18:23:40.475306: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-10-31 18:23:40.484349: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-10-31 18:23:40.488021: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-10-31 18:23:40.496556: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-10-31 18:23:44,409 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
2025-10-31 18:23:45,422 [INFO] NVIDIA runtime not detected. Forcing TensorFlow to CPU mode before import.
2025-10-31 18:23:45.478466: E external/local_xla/xla/stream_executor/cuda/cuda_driver.cc:266] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2025-10-31 18:23:45,478 [INFO] No GPU detected. TensorFlow will run on CPU. If you expected GPU support, confirm the NVIDIA drivers, container runtime, and '--gpus all' flag (for Docker) are configured.
2025-10-31 18:23:45,534 [WARNING] Alpaca API credentials not configured; skipping data fetches.
2025-10-31 18:23:45,555 [WARNING] Failed to load/compile LSTM: File not found: filepath=models/updated_lstm.keras. Please ensure the file is an accessible `.keras` zip file.
2025-10-31 18:23:45,556 [INFO] Script initialization completed, proceeding to main loop...
2025-10-31 18:23:45,559 [INFO] Attempting connection with clientId=100 to host.docker.internal:7496...
2025-10-31 18:23:45,559 [INFO] Connecting to host.docker.internal:7496 with clientId 100...
2025-10-31 18:23:45,563 [INFO] Connected
2025-10-31 18:23:45,566 [INFO] Logged on to server version 176
2025-10-31 18:23:45,572 [INFO] Warning 2104, reqId -1: Market data farm connection is OK:cafarm
2025-10-31 18:23:45,573 [INFO] Warning 2104, reqId -1: Market data farm connection is OK:hfarm
2025-10-31 18:23:45,573 [INFO] Warning 2104, reqId -1: Market data farm connection is OK:cashfarm
2025-10-31 18:23:45,573 [INFO] API connection ready
2025-10-31 18:23:45,574 [INFO] Warning 2104, reqId -1: Market data farm connection is OK:usopt.nj
2025-10-31 18:23:45,574 [INFO] Warning 2104, reqId -1: Market data farm connection is OK:jfarm
2025-10-31 18:23:45,575 [INFO] Warning 2104, reqId -1: Market data farm connection is OK:usfarm.nj
2025-10-31 18:23:45,575 [INFO] Warning 2104, reqId -1: Market data farm connection is OK:eufarm
2025-10-31 18:23:45,576 [INFO] Warning 2104, reqId -1: Market data farm connection is OK:usfarm
2025-10-31 18:23:45,576 [INFO] Warning 2106, reqId -1: HMDS data farm connection is OK:euhmds
2025-10-31 18:23:45,576 [INFO] Warning 2106, reqId -1: HMDS data farm connection is OK:apachmds
2025-10-31 18:23:45,577 [INFO] Warning 2106, reqId -1: HMDS data farm connection is OK:cashhmds
2025-10-31 18:23:45,577 [INFO] Warning 2106, reqId -1: HMDS data farm connection is OK:fundfarm
2025-10-31 18:23:45,578 [INFO] Warning 2106, reqId -1: HMDS data farm connection is OK:ushmds
2025-10-31 18:23:45,578 [INFO] Warning 2158, reqId -1: Sec-def data farm connection is OK:secdefhk
2025-10-31 18:23:45,579 [INFO] position: Position(account='U8353613', contract=Stock(conId=759923401, symbol='RGR', exchange='PURE', currency='CAD', localSymbol='RGR', tradingClass='RGR'), position=20000.0, avgCost=0.477525)
2025-10-31 18:23:45,579 [INFO] position: Position(account='U8353613', contract=Stock(conId=813720005, symbol='BDSX', exchange='ISLAND', currency='USD', localSymbol='BDSX', tradingClass='NMS'), position=1460.0, avgCost=7.794522)
2025-10-31 18:23:45,580 [INFO] position: Position(account='U8353613', contract=Stock(conId=468796852, symbol='TZA', exchange='ARCA', currency='USD', localSymbol='TZA', tradingClass='TZA'), position=16020.0, avgCost=8.054322)
2025-10-31 18:23:45,580 [INFO] position: Position(account='U8353613', contract=Stock(conId=269315, symbol='FI', exchange='NYSE', currency='USD', localSymbol='FI', tradingClass='FI'), position=5000.0, avgCost=127.369222)
2025-10-31 18:23:45,580 [INFO] position: Position(account='U8353613', contract=Stock(conId=311571413, symbol='BILI', exchange='ISLAND', currency='USD', localSymbol='BILI', tradingClass='NMS'), position=600.0, avgCost=26.915022)
2025-10-31 18:23:45,581 [INFO] position: Position(account='U8353613', contract=Stock(conId=762544244, symbol='ASBP', exchange='ISLAND', currency='USD', localSymbol='ASBP', tradingClass='NMS'), position=135513.0, avgCost=0.30655465)
2025-10-31 18:23:45,583 [INFO] position: Position(account='U8353613', contract=Stock(conId=139701596, symbol='FGBI', exchange='ISLAND', currency='USD', localSymbol='FGBI', tradingClass='NMS'), position=1206.0, avgCost=8.484997)
2025-10-31 18:23:45,583 [INFO] position: Position(account='U8353613', contract=Stock(conId=808840998, symbol='WEB', exchange='VENTURE', currency='CAD', localSymbol='WEB', tradingClass='WEB'), position=32000.0, avgCost=2.882475)
2025-10-31 18:23:45,584 [INFO] position: Position(account='U8353613', contract=Stock(conId=781532032, symbol='IQST', exchange='ISLAND', currency='USD', localSymbol='IQST', tradingClass='SCM'), position=18695.0, avgCost=6.79042675)
2025-10-31 18:23:45,584 [INFO] position: Position(account='U8353613', contract=Stock(conId=547336073, symbol='QIM', exchange='PURE', currency='CAD', localSymbol='QIM', tradingClass='QIM'), position=40200.0, avgCost=0.81825)
2025-10-31 18:23:45,584 [INFO] position: Position(account='U8353613', contract=Stock(conId=92216548, symbol='Z59', exchange='SGX', currency='SGD', localSymbol='Z59', tradingClass='Z59'), position=200000.0, avgCost=0.0810648)
2025-10-31 18:23:45,585 [INFO] position: Position(account='U8353613', contract=Stock(conId=705592547, symbol='QQQ', exchange='PURE', currency='CAD', localSymbol='QQQ', tradingClass='QQQ'), position=455000.0, avgCost=0.2162359)
2025-10-31 18:23:45,585 [INFO] position: Position(account='U8353613', contract=Stock(conId=818581630, symbol='WOLF.ESC', exchange='VALUE', currency='USD', localSymbol='WOLF.ESC', tradingClass='WOLF.ESC'), position=20000.0, avgCost=0.0)
2025-10-31 18:23:45,586 [INFO] position: Position(account='U8353613', contract=Stock(conId=603513998, symbol='4YL', exchange='FWB', currency='EUR', localSymbol='4YL', tradingClass='XETRA'), position=11396.0, avgCost=1.15379085)
2025-10-31 18:23:45,586 [INFO] position: Position(account='U8353613', contract=Stock(conId=459951634, symbol='NBTX', exchange='ISLAND', currency='USD', localSymbol='NBTX', tradingClass='NMS'), position=1365.0, avgCost=10.193832)
2025-10-31 18:23:45,587 [INFO] position: Position(account='U8353613', contract=Stock(conId=335906873, symbol='SONA', exchange='PURE', currency='CAD', localSymbol='SONA', tradingClass='SONA'), position=66100.0, avgCost=0.42771265)
2025-10-31 18:23:45,587 [INFO] position: Position(account='U8353613', contract=Stock(conId=383141417, symbol='NNVC', exchange='AMEX', currency='USD', localSymbol='NNVC', tradingClass='NNVC'), position=38730.0, avgCost=1.46184275)
2025-10-31 18:23:45,784 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=603513998, symbol='4YL', right='0', primaryExchange='FWB', currency='EUR', localSymbol='4YL', tradingClass='XETRA'), position=11396.0, marketPrice=1.1420512, marketValue=13014.82, averageCost=1.15379085, unrealizedPNL=-133.78, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,785 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=762544244, symbol='ASBP', right='0', primaryExchange='ISLAND', currency='USD', localSymbol='ASBP', tradingClass='NMS'), position=135513.0, marketPrice=0.38, marketValue=51494.94, averageCost=0.30655465, unrealizedPNL=9952.8, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,785 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=813720005, symbol='BDSX', right='0', primaryExchange='ISLAND', currency='USD', localSymbol='BDSX', tradingClass='NMS'), position=1460.0, marketPrice=6.54919005, marketValue=9561.82, averageCost=7.794522, unrealizedPNL=-1818.18, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,786 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=311571413, symbol='BILI', right='0', primaryExchange='ISLAND', currency='USD', localSymbol='BILI', tradingClass='NMS'), position=600.0, marketPrice=29.8999996, marketValue=17940.0, averageCost=26.915022, unrealizedPNL=1790.99, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,786 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=139701596, symbol='FGBI', right='0', primaryExchange='ISLAND', currency='USD', localSymbol='FGBI', tradingClass='NMS'), position=1206.0, marketPrice=6.7199998, marketValue=8104.32, averageCost=8.484997, unrealizedPNL=-2128.59, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,786 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=269315, symbol='FI', right='0', primaryExchange='NYSE', currency='USD', localSymbol='FI', tradingClass='FI'), position=5000.0, marketPrice=65.6800003, marketValue=328400.0, averageCost=127.369222, unrealizedPNL=-308446.11, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,787 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=781532032, symbol='IQST', right='0', primaryExchange='ISLAND', currency='USD', localSymbol='IQST', tradingClass='SCM'), position=18695.0, marketPrice=5.8299999, marketValue=108991.85, averageCost=6.79042675, unrealizedPNL=-17955.18, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,787 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=459951634, symbol='NBTX', right='0', primaryExchange='ISLAND', currency='USD', localSymbol='NBTX', tradingClass='NMS'), position=1365.0, marketPrice=20.4200001, marketValue=27873.3, averageCost=10.193832, unrealizedPNL=13958.72, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,788 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=383141417, symbol='NNVC', right='0', primaryExchange='AMEX', currency='USD', localSymbol='NNVC', tradingClass='NNVC'), position=38730.0, marketPrice=1.69059, marketValue=65476.55, averageCost=1.46184275, unrealizedPNL=8859.38, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,788 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=547336073, symbol='QIM', right='0', primaryExchange='PURE', currency='CAD', localSymbol='QIM', tradingClass='QIM'), position=40200.0, marketPrice=0.614426, marketValue=24699.93, averageCost=0.81825, unrealizedPNL=-8193.72, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,789 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=705592547, symbol='QQQ', right='0', primaryExchange='PURE', currency='CAD', localSymbol='QQQ', tradingClass='QQQ'), position=455000.0, marketPrice=0.134021, marketValue=60979.55, averageCost=0.2162359, unrealizedPNL=-37407.77, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,789 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=759923401, symbol='RGR', right='0', primaryExchange='PURE', currency='CAD', localSymbol='RGR', tradingClass='RGR'), position=20000.0, marketPrice=0.501547, marketValue=10030.94, averageCost=0.477525, unrealizedPNL=480.44, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,789 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=335906873, symbol='SONA', right='0', primaryExchange='PURE', currency='CAD', localSymbol='SONA', tradingClass='SONA'), position=66100.0, marketPrice=0.639237, marketValue=42253.56, averageCost=0.42771265, unrealizedPNL=13981.76, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,790 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=468796852, symbol='TZA', right='0', primaryExchange='ARCA', currency='USD', localSymbol='TZA', tradingClass='TZA'), position=16020.0, marketPrice=7.8899994, marketValue=126397.79, averageCost=8.054322, unrealizedPNL=-2632.45, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,790 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=808840998, symbol='WEB', right='0', primaryExchange='VENTURE', currency='CAD', localSymbol='WEB', tradingClass='WEB'), position=32000.0, marketPrice=2.61009, marketValue=83522.88, averageCost=2.882475, unrealizedPNL=-8716.32, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,791 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=818581630, symbol='WOLF.ESC', right='0', primaryExchange='VALUE', currency='USD', localSymbol='WOLF.ESC', tradingClass='WOLF.ESC'), position=20000.0, marketPrice=0.0, marketValue=0.0, averageCost=0.0, unrealizedPNL=0.0, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,791 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=92216548, symbol='Z59', right='0', primaryExchange='SGX', currency='SGD', localSymbol='Z59', tradingClass='Z59'), position=200000.0, marketPrice=0.082, marketValue=16400.0, averageCost=0.0810648, unrealizedPNL=187.04, realizedPNL=0.0, account='U8353613')
2025-10-31 18:23:45,884 [INFO] Synchronization complete
2025-10-31 18:23:47,887 [INFO] ✅ Connection validated with current time request.
2025-10-31 18:23:47,887 [INFO] ✅ Connected to IB Gateway successfully with clientId=100 (Account: U8353613).
2025-10-31 18:23:47,895 [INFO] ✅ Hourly jobs aligned to the top of each hour (bar close) starting at 2025-10-31 19:00 HKT HKT
2025-10-31 18:23:47,896 [INFO] ✅ Scheduled tasks: hourly trading synchronized to bar closes, US off-hours data sync immediately after, and daily reports at 04:00 HKT.
2025-10-31 18:23:47,896 [INFO] Running initial trading cycle at 18:23 HKT...
2025-10-31 18:23:47,901 [INFO] ✅ Loaded 30 tickers from /app/data/tickers.txt
2025-10-31 18:23:47,901 [INFO] Starting scheduled iteration at 18:23 HKT
2025-10-31 18:23:48,003 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:23:48,003 [WARNING] Retry 1/3 after 6.543350580060066s: You must supply a method of authentication
2025-10-31 18:23:54,547 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:23:54,548 [WARNING] Retry 2/3 after 11.667893846307503s: You must supply a method of authentication
2025-10-31 18:24:06,157 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:24:06,157 [ERROR] ❌ Error fetching S&P 500 data: You must supply a method of authentication. Falling back to Investing.com.
2025-10-31 18:24:06,323 [INFO] HTTP Request: GET https://www.investing.com/indices/s-p-500-stocks-above-20-day-average "HTTP/1.1 200 OK"
2025-10-31 18:24:06,405 [INFO] ✅ Investing.com S5TW fetched successfully: 34.79% above 20-day MA
2025-10-31 18:24:10,802 [INFO] Warning 2104, reqId -1: Market data farm connection is OK:usopt
2025-10-31 18:24:13,157 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:24:13,158 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:24:13,158 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:24:13,159 [INFO] 🕯️ Candlestick Patterns (1H): {}
2025-10-31 18:24:13,159 [INFO] 🕯️ Active Candlestick Patterns (1H): none
2025-10-31 18:24:13,159 [INFO] 🕯️ Candlestick Patterns (4H): {}
2025-10-31 18:24:13,160 [INFO] 🕯️ Active Candlestick Patterns (4H): none
2025-10-31 18:24:13,160 [INFO] 🕯️ Candlestick Patterns (1D): {}
2025-10-31 18:24:13,161 [INFO] 🕯️ Active Candlestick Patterns (1D): none
2025-10-31 18:24:13,173 [INFO] Discovered model artefacts in /app/models: rf_20251009T140002Z.joblib, rf_latest.joblib, rf_latest.meta.json, updated_lightgbm.pkl, updated_lstm.h5, updated_ppo.zip, updated_random_forest.pkl, updated_xgboost.pkl
2025-10-31 18:24:17,591 [WARNING] LightGBM supplied feature names ['Column_0', 'Column_1', 'Column_2', 'Column_3', 'Column_4'] that are unknown; falling back to positional alignment.
/home/appuser/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
2025-10-31 18:24:17,639 [ERROR] Failed to load LSTM model from /app/models/updated_lstm.h5: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 1, 91], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-10-31 18:24:17,904 [ERROR] Failed to load Transformer model from /app/models/updated_transformer: Error(s) in loading state_dict for Linear:
	size mismatch for bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([3]).
2025-10-31 18:24:17,905 [WARNING] Holding position: missing model artefacts detected (LSTM, Transformer).
2025-10-31 18:24:17,905 [INFO] ML decision for TSLL: HOLD
2025-10-31 18:24:17,920 [INFO] ⏳ No trade executed for TSLL. Stock decision: HOLD
2025-10-31 18:24:17,921 [INFO] No open position for TSLL; canceling any existing stop-loss orders
2025-10-31 18:24:17,983 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:24:17,983 [WARNING] Retry 1/3 after 5.639815033426145s: You must supply a method of authentication
2025-10-31 18:24:23,624 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:24:23,624 [WARNING] Retry 2/3 after 11.907016227445206s: You must supply a method of authentication
2025-10-31 18:24:35,465 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:24:35,465 [ERROR] ❌ Error fetching S&P 500 data: You must supply a method of authentication. Falling back to Investing.com.
2025-10-31 18:24:35,607 [INFO] HTTP Request: GET https://www.investing.com/indices/s-p-500-stocks-above-20-day-average "HTTP/1.1 200 OK"
2025-10-31 18:24:35,689 [INFO] ✅ Investing.com S5TW fetched successfully: 34.79% above 20-day MA
2025-10-31 18:24:42,361 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:24:42,361 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:24:42,362 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:24:42,362 [INFO] 🕯️ Candlestick Patterns (1H): {}
2025-10-31 18:24:42,363 [INFO] 🕯️ Active Candlestick Patterns (1H): none
2025-10-31 18:24:42,363 [INFO] 🕯️ Candlestick Patterns (4H): {}
2025-10-31 18:24:42,363 [INFO] 🕯️ Active Candlestick Patterns (4H): none
2025-10-31 18:24:42,364 [INFO] 🕯️ Candlestick Patterns (1D): {}
2025-10-31 18:24:42,364 [INFO] 🕯️ Active Candlestick Patterns (1D): none
/home/appuser/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
2025-10-31 18:24:42,385 [ERROR] Failed to load LSTM model from /app/models/updated_lstm.h5: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 1, 91], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-10-31 18:24:42,424 [ERROR] Failed to load Transformer model from /app/models/updated_transformer: Error(s) in loading state_dict for Linear:
	size mismatch for bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([3]).
2025-10-31 18:24:42,425 [WARNING] Holding position: missing model artefacts detected (LSTM, Transformer).
2025-10-31 18:24:42,426 [INFO] ML decision for TSLQ: HOLD
2025-10-31 18:24:42,441 [INFO] ⏳ No trade executed for TSLQ. Stock decision: HOLD
2025-10-31 18:24:42,441 [INFO] No open position for TSLQ; canceling any existing stop-loss orders
2025-10-31 18:24:42,501 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:24:42,502 [WARNING] Retry 1/3 after 5.130613867930283s: You must supply a method of authentication
2025-10-31 18:24:47,635 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:24:47,636 [WARNING] Retry 2/3 after 10.07776456135911s: You must supply a method of authentication
2025-10-31 18:24:57,657 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:24:57,658 [ERROR] ❌ Error fetching S&P 500 data: You must supply a method of authentication. Falling back to Investing.com.
2025-10-31 18:24:57,800 [INFO] HTTP Request: GET https://www.investing.com/indices/s-p-500-stocks-above-20-day-average "HTTP/1.1 200 OK"
2025-10-31 18:24:57,883 [INFO] ✅ Investing.com S5TW fetched successfully: 34.79% above 20-day MA
2025-10-31 18:24:57,884 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=269315, symbol='FI', right='0', primaryExchange='NYSE', currency='USD', localSymbol='FI', tradingClass='FI'), position=5000.0, marketPrice=65.7200012, marketValue=328600.01, averageCost=127.369222, unrealizedPNL=-308246.1, realizedPNL=0.0, account='U8353613')
2025-10-31 18:24:57,885 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=459951634, symbol='NBTX', right='0', primaryExchange='ISLAND', currency='USD', localSymbol='NBTX', tradingClass='NMS'), position=1365.0, marketPrice=20.3600006, marketValue=27791.4, averageCost=10.193832, unrealizedPNL=13876.82, realizedPNL=0.0, account='U8353613')
2025-10-31 18:24:57,885 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=468796852, symbol='TZA', right='0', primaryExchange='ARCA', currency='USD', localSymbol='TZA', tradingClass='TZA'), position=16020.0, marketPrice=7.8800001, marketValue=126237.6, averageCost=8.054322, unrealizedPNL=-2792.64, realizedPNL=0.0, account='U8353613')
2025-10-31 18:25:00,053 [ERROR] Error 200, reqId 80907: No security definition has been found for the request, contract: Option(symbol='ASMG', lastTradeDateOrContractMonth='20251031', right='C', exchange='SMART', currency='USD')
2025-10-31 18:25:05,021 [ERROR] Error 200, reqId 80908: No security definition has been found for the request, contract: Option(symbol='ASMG', lastTradeDateOrContractMonth='20251107', right='C', exchange='SMART', currency='USD')
2025-10-31 18:25:10,026 [ERROR] Error 200, reqId 80909: No security definition has been found for the request, contract: Option(symbol='ASMG', lastTradeDateOrContractMonth='20251114', right='C', exchange='SMART', currency='USD')
2025-10-31 18:25:15,443 [ERROR] Error 200, reqId 80911: No security definition has been found for the request, contract: Option(symbol='ASMG', lastTradeDateOrContractMonth='20251031', strike=27.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:25:15,444 [WARNING] Unknown contract: Option(symbol='ASMG', lastTradeDateOrContractMonth='20251031', strike=27.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:25:15,520 [ERROR] Error 200, reqId 80912: No security definition has been found for the request, contract: Option(symbol='ASMG', lastTradeDateOrContractMonth='20251031', strike=27.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:25:15,521 [WARNING] Unknown contract: Option(symbol='ASMG', lastTradeDateOrContractMonth='20251031', strike=27.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:25:15,521 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:25:15,522 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:25:15,522 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:25:15,522 [INFO] 🕯️ Candlestick Patterns (1H): {}
2025-10-31 18:25:15,523 [INFO] 🕯️ Active Candlestick Patterns (1H): none
2025-10-31 18:25:15,523 [INFO] 🕯️ Candlestick Patterns (4H): {}
2025-10-31 18:25:15,524 [INFO] 🕯️ Active Candlestick Patterns (4H): none
2025-10-31 18:25:15,524 [INFO] 🕯️ Candlestick Patterns (1D): {}
2025-10-31 18:25:15,524 [INFO] 🕯️ Active Candlestick Patterns (1D): none
/home/appuser/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
2025-10-31 18:25:15,544 [ERROR] Failed to load LSTM model from /app/models/updated_lstm.h5: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 1, 91], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-10-31 18:25:15,583 [ERROR] Failed to load Transformer model from /app/models/updated_transformer: Error(s) in loading state_dict for Linear:
	size mismatch for bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([3]).
2025-10-31 18:25:15,584 [WARNING] Holding position: missing model artefacts detected (LSTM, Transformer).
2025-10-31 18:25:15,585 [INFO] ML decision for ASMG: HOLD
2025-10-31 18:25:15,600 [INFO] ⏳ No trade executed for ASMG. Stock decision: HOLD
2025-10-31 18:25:15,600 [INFO] No open position for ASMG; canceling any existing stop-loss orders
2025-10-31 18:25:15,699 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:25:15,700 [WARNING] Retry 1/3 after 6.194226971922444s: You must supply a method of authentication
2025-10-31 18:25:21,895 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:25:21,895 [WARNING] Retry 2/3 after 11.737807905038565s: You must supply a method of authentication
2025-10-31 18:25:33,575 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:25:33,575 [ERROR] ❌ Error fetching S&P 500 data: You must supply a method of authentication. Falling back to Investing.com.
2025-10-31 18:25:33,777 [INFO] HTTP Request: GET https://www.investing.com/indices/s-p-500-stocks-above-20-day-average "HTTP/1.1 200 OK"
2025-10-31 18:25:33,862 [INFO] ✅ Investing.com S5TW fetched successfully: 34.79% above 20-day MA
2025-10-31 18:25:36,069 [ERROR] Error 200, reqId 80916: No security definition has been found for the request, contract: Option(symbol='FNGU', lastTradeDateOrContractMonth='20251031', right='C', exchange='SMART', currency='USD')
2025-10-31 18:25:41,081 [ERROR] Error 200, reqId 80917: No security definition has been found for the request, contract: Option(symbol='FNGU', lastTradeDateOrContractMonth='20251107', right='C', exchange='SMART', currency='USD')
2025-10-31 18:25:46,110 [ERROR] Error 200, reqId 80918: No security definition has been found for the request, contract: Option(symbol='FNGU', lastTradeDateOrContractMonth='20251114', right='C', exchange='SMART', currency='USD')
2025-10-31 18:25:51,147 [ERROR] Error 200, reqId 80919: No security definition has been found for the request, contract: Option(symbol='FNGU', lastTradeDateOrContractMonth='20251121', right='C', exchange='SMART', currency='USD')
2025-10-31 18:25:56,186 [ERROR] Error 200, reqId 80920: No security definition has been found for the request, contract: Option(symbol='FNGU', lastTradeDateOrContractMonth='20251128', right='C', exchange='SMART', currency='USD')
2025-10-31 18:26:01,099 [ERROR] Error 200, reqId 80921: No security definition has been found for the request, contract: Option(symbol='FNGU', lastTradeDateOrContractMonth='20251205', right='C', exchange='SMART', currency='USD')
2025-10-31 18:26:06,082 [ERROR] Error 200, reqId 80922: No security definition has been found for the request, contract: Option(symbol='FNGU', lastTradeDateOrContractMonth='20251212', right='C', exchange='SMART', currency='USD')
2025-10-31 18:26:11,095 [ERROR] Error 200, reqId 80923: No security definition has been found for the request, contract: Option(symbol='FNGU', lastTradeDateOrContractMonth='20251219', right='C', exchange='SMART', currency='USD')
2025-10-31 18:26:16,126 [ERROR] Error 200, reqId 80924: No security definition has been found for the request, contract: Option(symbol='FNGU', lastTradeDateOrContractMonth='20251226', right='C', exchange='SMART', currency='USD')
2025-10-31 18:26:21,165 [ERROR] Error 200, reqId 80925: No security definition has been found for the request, contract: Option(symbol='FNGU', lastTradeDateOrContractMonth='20260102', right='C', exchange='SMART', currency='USD')
2025-10-31 18:26:26,204 [ERROR] Error 200, reqId 80926: No security definition has been found for the request, contract: Option(symbol='FNGU', lastTradeDateOrContractMonth='20260109', right='C', exchange='SMART', currency='USD')
2025-10-31 18:26:31,111 [ERROR] Error 200, reqId 80927: No security definition has been found for the request, contract: Option(symbol='FNGU', lastTradeDateOrContractMonth='20260116', right='C', exchange='SMART', currency='USD')
2025-10-31 18:26:31,112 [ERROR] ❌ No valid CALL strikes for FNGU after 12 weeks
2025-10-31 18:26:31,113 [ERROR] ❌ No valid CALL strikes for FNGU after 12 weeks
2025-10-31 18:26:31,114 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:26:31,114 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:26:31,115 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:26:31,115 [INFO] 🕯️ Candlestick Patterns (1H): {}
2025-10-31 18:26:31,116 [INFO] 🕯️ Active Candlestick Patterns (1H): none
2025-10-31 18:26:31,116 [INFO] 🕯️ Candlestick Patterns (4H): {}
2025-10-31 18:26:31,116 [INFO] 🕯️ Active Candlestick Patterns (4H): none
2025-10-31 18:26:31,117 [INFO] 🕯️ Candlestick Patterns (1D): {}
2025-10-31 18:26:31,117 [INFO] 🕯️ Active Candlestick Patterns (1D): none
/home/appuser/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
2025-10-31 18:26:31,173 [ERROR] Failed to load LSTM model from /app/models/updated_lstm.h5: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 1, 91], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-10-31 18:26:31,230 [ERROR] Failed to load Transformer model from /app/models/updated_transformer: Error(s) in loading state_dict for Linear:
	size mismatch for bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([3]).
2025-10-31 18:26:31,231 [WARNING] Holding position: missing model artefacts detected (LSTM, Transformer).
2025-10-31 18:26:31,232 [INFO] ML decision for FNGU: HOLD
2025-10-31 18:26:31,247 [INFO] ⏳ No trade executed for FNGU. Stock decision: HOLD
2025-10-31 18:26:31,248 [INFO] No open position for FNGU; canceling any existing stop-loss orders
2025-10-31 18:26:31,309 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:26:31,310 [WARNING] Retry 1/3 after 5.691457158493854s: You must supply a method of authentication
2025-10-31 18:26:37,002 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:26:37,003 [WARNING] Retry 2/3 after 11.79750937666526s: You must supply a method of authentication
2025-10-31 18:26:48,801 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:26:48,802 [ERROR] ❌ Error fetching S&P 500 data: You must supply a method of authentication. Falling back to Investing.com.
2025-10-31 18:26:48,959 [INFO] HTTP Request: GET https://www.investing.com/indices/s-p-500-stocks-above-20-day-average "HTTP/1.1 200 OK"
2025-10-31 18:26:49,048 [INFO] ✅ Investing.com S5TW fetched successfully: 34.79% above 20-day MA
2025-10-31 18:26:56,058 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:26:56,058 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:26:56,059 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:26:56,059 [INFO] 🕯️ Candlestick Patterns (1H): {}
2025-10-31 18:26:56,060 [INFO] 🕯️ Active Candlestick Patterns (1H): none
2025-10-31 18:26:56,060 [INFO] 🕯️ Candlestick Patterns (4H): {}
2025-10-31 18:26:56,060 [INFO] 🕯️ Active Candlestick Patterns (4H): none
2025-10-31 18:26:56,061 [INFO] 🕯️ Candlestick Patterns (1D): {}
2025-10-31 18:26:56,061 [INFO] 🕯️ Active Candlestick Patterns (1D): none
/home/appuser/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
2025-10-31 18:26:56,081 [ERROR] Failed to load LSTM model from /app/models/updated_lstm.h5: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 1, 91], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-10-31 18:26:56,121 [ERROR] Failed to load Transformer model from /app/models/updated_transformer: Error(s) in loading state_dict for Linear:
	size mismatch for bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([3]).
2025-10-31 18:26:56,122 [WARNING] Holding position: missing model artefacts detected (LSTM, Transformer).
2025-10-31 18:26:56,123 [INFO] ML decision for SOXL: HOLD
2025-10-31 18:26:56,138 [INFO] ⏳ No trade executed for SOXL. Stock decision: HOLD
2025-10-31 18:26:56,139 [INFO] No open position for SOXL; canceling any existing stop-loss orders
2025-10-31 18:26:56,200 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:26:56,201 [WARNING] Retry 1/3 after 5.845371666980532s: You must supply a method of authentication
2025-10-31 18:27:01,982 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:27:01,983 [WARNING] Retry 2/3 after 10.5746921979085s: You must supply a method of authentication
2025-10-31 18:27:12,558 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:27:12,558 [ERROR] ❌ Error fetching S&P 500 data: You must supply a method of authentication. Falling back to Investing.com.
2025-10-31 18:27:12,715 [INFO] HTTP Request: GET https://www.investing.com/indices/s-p-500-stocks-above-20-day-average "HTTP/1.1 200 OK"
2025-10-31 18:27:12,802 [INFO] ✅ Investing.com S5TW fetched successfully: 34.79% above 20-day MA
2025-10-31 18:27:19,887 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:27:19,887 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:27:19,887 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:27:19,888 [INFO] 🕯️ Candlestick Patterns (1H): {}
2025-10-31 18:27:19,888 [INFO] 🕯️ Active Candlestick Patterns (1H): none
2025-10-31 18:27:19,889 [INFO] 🕯️ Candlestick Patterns (4H): {}
2025-10-31 18:27:19,889 [INFO] 🕯️ Active Candlestick Patterns (4H): none
2025-10-31 18:27:19,889 [INFO] 🕯️ Candlestick Patterns (1D): {}
2025-10-31 18:27:19,890 [INFO] 🕯️ Active Candlestick Patterns (1D): none
/home/appuser/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
2025-10-31 18:27:19,910 [ERROR] Failed to load LSTM model from /app/models/updated_lstm.h5: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 1, 91], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-10-31 18:27:19,948 [ERROR] Failed to load Transformer model from /app/models/updated_transformer: Error(s) in loading state_dict for Linear:
	size mismatch for bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([3]).
2025-10-31 18:27:19,949 [WARNING] Holding position: missing model artefacts detected (LSTM, Transformer).
2025-10-31 18:27:19,949 [INFO] ML decision for SPXL: HOLD
2025-10-31 18:27:19,965 [INFO] ⏳ No trade executed for SPXL. Stock decision: HOLD
2025-10-31 18:27:19,965 [INFO] No open position for SPXL; canceling any existing stop-loss orders
2025-10-31 18:27:20,025 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:27:20,026 [WARNING] Retry 1/3 after 6.4744458988798215s: You must supply a method of authentication
2025-10-31 18:27:26,505 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:27:26,505 [WARNING] Retry 2/3 after 11.352902101849342s: You must supply a method of authentication
2025-10-31 18:27:37,783 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:27:37,783 [ERROR] ❌ Error fetching S&P 500 data: You must supply a method of authentication. Falling back to Investing.com.
2025-10-31 18:27:37,923 [INFO] HTTP Request: GET https://www.investing.com/indices/s-p-500-stocks-above-20-day-average "HTTP/1.1 200 OK"
2025-10-31 18:27:38,005 [INFO] ✅ Investing.com S5TW fetched successfully: 34.79% above 20-day MA
2025-10-31 18:27:40,157 [ERROR] Error 200, reqId 80947: No security definition has been found for the request, contract: Option(symbol='CRWL', lastTradeDateOrContractMonth='20251031', right='C', exchange='SMART', currency='USD')
2025-10-31 18:27:45,184 [ERROR] Error 200, reqId 80948: No security definition has been found for the request, contract: Option(symbol='CRWL', lastTradeDateOrContractMonth='20251107', right='C', exchange='SMART', currency='USD')
2025-10-31 18:27:46,392 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=269315, symbol='FI', right='0', primaryExchange='NYSE', currency='USD', localSymbol='FI', tradingClass='FI'), position=5000.0, marketPrice=65.80000305, marketValue=329000.02, averageCost=127.369222, unrealizedPNL=-307846.09, realizedPNL=0.0, account='U8353613')
2025-10-31 18:27:46,393 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=311571413, symbol='BILI', right='0', primaryExchange='ISLAND', currency='USD', localSymbol='BILI', tradingClass='NMS'), position=600.0, marketPrice=29.87999915, marketValue=17928.0, averageCost=26.915022, unrealizedPNL=1778.99, realizedPNL=0.0, account='U8353613')
2025-10-31 18:27:46,393 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=459951634, symbol='NBTX', right='0', primaryExchange='ISLAND', currency='USD', localSymbol='NBTX', tradingClass='NMS'), position=1365.0, marketPrice=20.1499996, marketValue=27504.75, averageCost=10.193832, unrealizedPNL=13590.17, realizedPNL=0.0, account='U8353613')
2025-10-31 18:27:46,394 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=468796852, symbol='TZA', right='0', primaryExchange='ARCA', currency='USD', localSymbol='TZA', tradingClass='TZA'), position=16020.0, marketPrice=7.8863344, marketValue=126339.08, averageCost=8.054322, unrealizedPNL=-2691.16, realizedPNL=0.0, account='U8353613')
2025-10-31 18:27:46,394 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=762544244, symbol='ASBP', right='0', primaryExchange='ISLAND', currency='USD', localSymbol='ASBP', tradingClass='NMS'), position=135513.0, marketPrice=0.3764, marketValue=51007.09, averageCost=0.30655465, unrealizedPNL=9464.96, realizedPNL=0.0, account='U8353613')
2025-10-31 18:27:50,219 [ERROR] Error 200, reqId 80949: No security definition has been found for the request, contract: Option(symbol='CRWL', lastTradeDateOrContractMonth='20251114', right='C', exchange='SMART', currency='USD')
2025-10-31 18:27:55,606 [ERROR] Error 200, reqId 80951: No security definition has been found for the request, contract: Option(symbol='CRWL', lastTradeDateOrContractMonth='20251031', strike=43.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:27:55,607 [WARNING] Unknown contract: Option(symbol='CRWL', lastTradeDateOrContractMonth='20251031', strike=43.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:27:55,685 [ERROR] Error 200, reqId 80952: No security definition has been found for the request, contract: Option(symbol='CRWL', lastTradeDateOrContractMonth='20251031', strike=43.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:27:55,685 [WARNING] Unknown contract: Option(symbol='CRWL', lastTradeDateOrContractMonth='20251031', strike=43.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:27:55,686 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:27:55,686 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:27:55,686 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:27:55,687 [INFO] 🕯️ Candlestick Patterns (1H): {}
2025-10-31 18:27:55,687 [INFO] 🕯️ Active Candlestick Patterns (1H): none
2025-10-31 18:27:55,688 [INFO] 🕯️ Candlestick Patterns (4H): {}
2025-10-31 18:27:55,688 [INFO] 🕯️ Active Candlestick Patterns (4H): none
2025-10-31 18:27:55,689 [INFO] 🕯️ Candlestick Patterns (1D): {}
2025-10-31 18:27:55,689 [INFO] 🕯️ Active Candlestick Patterns (1D): none
/home/appuser/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
2025-10-31 18:27:55,709 [ERROR] Failed to load LSTM model from /app/models/updated_lstm.h5: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 1, 91], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-10-31 18:27:55,750 [ERROR] Failed to load Transformer model from /app/models/updated_transformer: Error(s) in loading state_dict for Linear:
	size mismatch for bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([3]).
2025-10-31 18:27:55,751 [WARNING] Holding position: missing model artefacts detected (LSTM, Transformer).
2025-10-31 18:27:55,752 [INFO] ML decision for CRWL: HOLD
2025-10-31 18:27:55,768 [INFO] ⏳ No trade executed for CRWL. Stock decision: HOLD
2025-10-31 18:27:55,769 [INFO] No open position for CRWL; canceling any existing stop-loss orders
2025-10-31 18:27:55,830 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:27:55,830 [WARNING] Retry 1/3 after 5.969628239507362s: You must supply a method of authentication
2025-10-31 18:28:01,732 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:28:01,732 [WARNING] Retry 2/3 after 11.735212681289186s: You must supply a method of authentication
2025-10-31 18:28:13,482 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:28:13,482 [ERROR] ❌ Error fetching S&P 500 data: You must supply a method of authentication. Falling back to Investing.com.
2025-10-31 18:28:13,640 [INFO] HTTP Request: GET https://www.investing.com/indices/s-p-500-stocks-above-20-day-average "HTTP/1.1 200 OK"
2025-10-31 18:28:13,725 [INFO] ✅ Investing.com S5TW fetched successfully: 34.79% above 20-day MA
2025-10-31 18:28:15,934 [ERROR] Error 200, reqId 80956: No security definition has been found for the request, contract: Option(symbol='PLTU', lastTradeDateOrContractMonth='20251031', right='C', exchange='SMART', currency='USD')
2025-10-31 18:28:20,977 [ERROR] Error 200, reqId 80957: No security definition has been found for the request, contract: Option(symbol='PLTU', lastTradeDateOrContractMonth='20251107', right='C', exchange='SMART', currency='USD')
2025-10-31 18:28:26,017 [ERROR] Error 200, reqId 80958: No security definition has been found for the request, contract: Option(symbol='PLTU', lastTradeDateOrContractMonth='20251114', right='C', exchange='SMART', currency='USD')
2025-10-31 18:28:30,911 [ERROR] Error 200, reqId 80959: No security definition has been found for the request, contract: Option(symbol='PLTU', lastTradeDateOrContractMonth='20251121', right='C', exchange='SMART', currency='USD')
2025-10-31 18:28:35,898 [ERROR] Error 200, reqId 80960: No security definition has been found for the request, contract: Option(symbol='PLTU', lastTradeDateOrContractMonth='20251128', right='C', exchange='SMART', currency='USD')
2025-10-31 18:28:40,914 [ERROR] Error 200, reqId 80961: No security definition has been found for the request, contract: Option(symbol='PLTU', lastTradeDateOrContractMonth='20251205', right='C', exchange='SMART', currency='USD')
2025-10-31 18:28:45,943 [ERROR] Error 200, reqId 80962: No security definition has been found for the request, contract: Option(symbol='PLTU', lastTradeDateOrContractMonth='20251212', right='C', exchange='SMART', currency='USD')
2025-10-31 18:28:50,978 [ERROR] Error 200, reqId 80963: No security definition has been found for the request, contract: Option(symbol='PLTU', lastTradeDateOrContractMonth='20251219', right='C', exchange='SMART', currency='USD')
2025-10-31 18:28:56,017 [ERROR] Error 200, reqId 80964: No security definition has been found for the request, contract: Option(symbol='PLTU', lastTradeDateOrContractMonth='20251226', right='C', exchange='SMART', currency='USD')
2025-10-31 18:29:00,921 [ERROR] Error 200, reqId 80965: No security definition has been found for the request, contract: Option(symbol='PLTU', lastTradeDateOrContractMonth='20260102', right='C', exchange='SMART', currency='USD')
2025-10-31 18:29:05,909 [ERROR] Error 200, reqId 80966: No security definition has been found for the request, contract: Option(symbol='PLTU', lastTradeDateOrContractMonth='20260109', right='C', exchange='SMART', currency='USD')
2025-10-31 18:29:10,924 [ERROR] Error 200, reqId 80967: No security definition has been found for the request, contract: Option(symbol='PLTU', lastTradeDateOrContractMonth='20260116', right='C', exchange='SMART', currency='USD')
2025-10-31 18:29:10,925 [ERROR] ❌ No valid CALL strikes for PLTU after 12 weeks
2025-10-31 18:29:10,925 [ERROR] ❌ No valid CALL strikes for PLTU after 12 weeks
2025-10-31 18:29:10,926 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:29:10,926 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:29:10,927 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:29:10,927 [INFO] 🕯️ Candlestick Patterns (1H): {}
2025-10-31 18:29:10,927 [INFO] 🕯️ Active Candlestick Patterns (1H): none
2025-10-31 18:29:10,928 [INFO] 🕯️ Candlestick Patterns (4H): {}
2025-10-31 18:29:10,928 [INFO] 🕯️ Active Candlestick Patterns (4H): none
2025-10-31 18:29:10,929 [INFO] 🕯️ Candlestick Patterns (1D): {}
2025-10-31 18:29:10,929 [INFO] 🕯️ Active Candlestick Patterns (1D): none
/home/appuser/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
2025-10-31 18:29:10,951 [ERROR] Failed to load LSTM model from /app/models/updated_lstm.h5: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 1, 91], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-10-31 18:29:10,989 [ERROR] Failed to load Transformer model from /app/models/updated_transformer: Error(s) in loading state_dict for Linear:
	size mismatch for bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([3]).
2025-10-31 18:29:10,990 [WARNING] Holding position: missing model artefacts detected (LSTM, Transformer).
2025-10-31 18:29:10,990 [INFO] ML decision for PLTU: HOLD
2025-10-31 18:29:11,005 [INFO] ⏳ No trade executed for PLTU. Stock decision: HOLD
2025-10-31 18:29:11,005 [INFO] No open position for PLTU; canceling any existing stop-loss orders
2025-10-31 18:29:11,065 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:29:11,066 [WARNING] Retry 1/3 after 5.869073558441646s: You must supply a method of authentication
2025-10-31 18:29:16,941 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:29:16,942 [WARNING] Retry 2/3 after 11.738488612919895s: You must supply a method of authentication
2025-10-31 18:29:28,620 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:29:28,621 [ERROR] ❌ Error fetching S&P 500 data: You must supply a method of authentication. Falling back to Investing.com.
2025-10-31 18:29:28,769 [INFO] HTTP Request: GET https://www.investing.com/indices/s-p-500-stocks-above-20-day-average "HTTP/1.1 200 OK"
2025-10-31 18:29:28,847 [INFO] ✅ Investing.com S5TW fetched successfully: 34.79% above 20-day MA
2025-10-31 18:29:31,027 [ERROR] Error 200, reqId 80971: No security definition has been found for the request, contract: Option(symbol='AMZU', lastTradeDateOrContractMonth='20251031', right='C', exchange='SMART', currency='USD')
2025-10-31 18:29:36,019 [ERROR] Error 200, reqId 80972: No security definition has been found for the request, contract: Option(symbol='AMZU', lastTradeDateOrContractMonth='20251107', right='C', exchange='SMART', currency='USD')
2025-10-31 18:29:41,036 [ERROR] Error 200, reqId 80973: No security definition has been found for the request, contract: Option(symbol='AMZU', lastTradeDateOrContractMonth='20251114', right='C', exchange='SMART', currency='USD')
2025-10-31 18:29:46,600 [ERROR] Error 200, reqId 80975: No security definition has been found for the request, contract: Option(symbol='AMZU', lastTradeDateOrContractMonth='20251031', strike=45.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:29:46,600 [WARNING] Unknown contract: Option(symbol='AMZU', lastTradeDateOrContractMonth='20251031', strike=45.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:29:46,680 [ERROR] Error 200, reqId 80976: No security definition has been found for the request, contract: Option(symbol='AMZU', lastTradeDateOrContractMonth='20251031', strike=45.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:29:46,681 [WARNING] Unknown contract: Option(symbol='AMZU', lastTradeDateOrContractMonth='20251031', strike=45.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:29:46,682 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:29:46,682 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:29:46,683 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:29:46,683 [INFO] 🕯️ Candlestick Patterns (1H): {}
2025-10-31 18:29:46,683 [INFO] 🕯️ Active Candlestick Patterns (1H): none
2025-10-31 18:29:46,684 [INFO] 🕯️ Candlestick Patterns (4H): {}
2025-10-31 18:29:46,684 [INFO] 🕯️ Active Candlestick Patterns (4H): none
2025-10-31 18:29:46,685 [INFO] 🕯️ Candlestick Patterns (1D): {}
2025-10-31 18:29:46,685 [INFO] 🕯️ Active Candlestick Patterns (1D): none
/home/appuser/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
2025-10-31 18:29:46,705 [ERROR] Failed to load LSTM model from /app/models/updated_lstm.h5: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 1, 91], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-10-31 18:29:46,743 [ERROR] Failed to load Transformer model from /app/models/updated_transformer: Error(s) in loading state_dict for Linear:
	size mismatch for bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([3]).
2025-10-31 18:29:46,744 [WARNING] Holding position: missing model artefacts detected (LSTM, Transformer).
2025-10-31 18:29:46,744 [INFO] ML decision for AMZU: HOLD
2025-10-31 18:29:46,758 [INFO] ⏳ No trade executed for AMZU. Stock decision: HOLD
2025-10-31 18:29:46,759 [INFO] No open position for AMZU; canceling any existing stop-loss orders
2025-10-31 18:29:46,818 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:29:46,819 [WARNING] Retry 1/3 after 5.059784910719142s: You must supply a method of authentication
2025-10-31 18:29:51,880 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:29:51,881 [WARNING] Retry 2/3 after 10.077651414514298s: You must supply a method of authentication
2025-10-31 18:30:01,885 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:30:01,885 [ERROR] ❌ Error fetching S&P 500 data: You must supply a method of authentication. Falling back to Investing.com.
2025-10-31 18:30:02,048 [INFO] HTTP Request: GET https://www.investing.com/indices/s-p-500-stocks-above-20-day-average "HTTP/1.1 200 OK"
2025-10-31 18:30:02,140 [INFO] ✅ Investing.com S5TW fetched successfully: 34.79% above 20-day MA
2025-10-31 18:30:04,297 [ERROR] Error 200, reqId 80980: No security definition has been found for the request, contract: Option(symbol='METU', lastTradeDateOrContractMonth='20251031', right='C', exchange='SMART', currency='USD')
2025-10-31 18:30:09,307 [ERROR] Error 200, reqId 80981: No security definition has been found for the request, contract: Option(symbol='METU', lastTradeDateOrContractMonth='20251107', right='C', exchange='SMART', currency='USD')
2025-10-31 18:30:14,334 [ERROR] Error 200, reqId 80982: No security definition has been found for the request, contract: Option(symbol='METU', lastTradeDateOrContractMonth='20251114', right='C', exchange='SMART', currency='USD')
2025-10-31 18:30:19,978 [ERROR] Error 200, reqId 80984: No security definition has been found for the request, contract: Option(symbol='METU', lastTradeDateOrContractMonth='20251031', strike=35.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:30:19,978 [WARNING] Unknown contract: Option(symbol='METU', lastTradeDateOrContractMonth='20251031', strike=35.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:30:20,056 [ERROR] Error 200, reqId 80985: No security definition has been found for the request, contract: Option(symbol='METU', lastTradeDateOrContractMonth='20251031', strike=35.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:30:20,057 [WARNING] Unknown contract: Option(symbol='METU', lastTradeDateOrContractMonth='20251031', strike=35.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:30:20,057 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:30:20,058 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:30:20,058 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:30:20,058 [INFO] 🕯️ Candlestick Patterns (1H): {}
2025-10-31 18:30:20,059 [INFO] 🕯️ Active Candlestick Patterns (1H): none
2025-10-31 18:30:20,059 [INFO] 🕯️ Candlestick Patterns (4H): {}
2025-10-31 18:30:20,059 [INFO] 🕯️ Active Candlestick Patterns (4H): none
2025-10-31 18:30:20,060 [INFO] 🕯️ Candlestick Patterns (1D): {}
2025-10-31 18:30:20,060 [INFO] 🕯️ Active Candlestick Patterns (1D): none
/home/appuser/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
2025-10-31 18:30:20,080 [ERROR] Failed to load LSTM model from /app/models/updated_lstm.h5: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 1, 91], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-10-31 18:30:20,117 [ERROR] Failed to load Transformer model from /app/models/updated_transformer: Error(s) in loading state_dict for Linear:
	size mismatch for bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([3]).
2025-10-31 18:30:20,119 [WARNING] Holding position: missing model artefacts detected (LSTM, Transformer).
2025-10-31 18:30:20,119 [INFO] ML decision for METU: HOLD
2025-10-31 18:30:20,134 [INFO] ⏳ No trade executed for METU. Stock decision: HOLD
2025-10-31 18:30:20,134 [INFO] No open position for METU; canceling any existing stop-loss orders
2025-10-31 18:30:20,194 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:30:20,194 [WARNING] Retry 1/3 after 5.03691892700431s: You must supply a method of authentication
2025-10-31 18:30:25,232 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:30:25,232 [WARNING] Retry 2/3 after 10.26385961420135s: You must supply a method of authentication
2025-10-31 18:30:35,427 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:30:35,427 [ERROR] ❌ Error fetching S&P 500 data: You must supply a method of authentication. Falling back to Investing.com.
2025-10-31 18:30:35,577 [INFO] HTTP Request: GET https://www.investing.com/indices/s-p-500-stocks-above-20-day-average "HTTP/1.1 200 OK"
2025-10-31 18:30:35,660 [INFO] ✅ Investing.com S5TW fetched successfully: 34.79% above 20-day MA
2025-10-31 18:30:37,831 [ERROR] Error 200, reqId 80989: No security definition has been found for the request, contract: Option(symbol='AAPU', lastTradeDateOrContractMonth='20251031', right='C', exchange='SMART', currency='USD')
2025-10-31 18:30:42,853 [ERROR] Error 200, reqId 80990: No security definition has been found for the request, contract: Option(symbol='AAPU', lastTradeDateOrContractMonth='20251107', right='C', exchange='SMART', currency='USD')
2025-10-31 18:30:46,414 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=269315, symbol='FI', right='0', primaryExchange='NYSE', currency='USD', localSymbol='FI', tradingClass='FI'), position=5000.0, marketPrice=65.7099991, marketValue=328550.0, averageCost=127.369222, unrealizedPNL=-308296.11, realizedPNL=0.0, account='U8353613')
2025-10-31 18:30:46,415 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=311571413, symbol='BILI', right='0', primaryExchange='ISLAND', currency='USD', localSymbol='BILI', tradingClass='NMS'), position=600.0, marketPrice=29.87999915, marketValue=17928.0, averageCost=26.915022, unrealizedPNL=1778.99, realizedPNL=0.0, account='U8353613')
2025-10-31 18:30:46,415 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=459951634, symbol='NBTX', right='0', primaryExchange='ISLAND', currency='USD', localSymbol='NBTX', tradingClass='NMS'), position=1365.0, marketPrice=20.01000025, marketValue=27313.65, averageCost=10.193832, unrealizedPNL=13399.07, realizedPNL=0.0, account='U8353613')
2025-10-31 18:30:46,416 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=468796852, symbol='TZA', right='0', primaryExchange='ARCA', currency='USD', localSymbol='TZA', tradingClass='TZA'), position=16020.0, marketPrice=7.8800001, marketValue=126237.6, averageCost=8.054322, unrealizedPNL=-2792.64, realizedPNL=0.0, account='U8353613')
2025-10-31 18:30:46,416 [INFO] updatePortfolio: PortfolioItem(contract=Stock(conId=762544244, symbol='ASBP', right='0', primaryExchange='ISLAND', currency='USD', localSymbol='ASBP', tradingClass='NMS'), position=135513.0, marketPrice=0.3764, marketValue=51007.09, averageCost=0.30655465, unrealizedPNL=9464.96, realizedPNL=0.0, account='U8353613')
2025-10-31 18:30:47,887 [ERROR] Error 200, reqId 80991: No security definition has been found for the request, contract: Option(symbol='AAPU', lastTradeDateOrContractMonth='20251114', right='C', exchange='SMART', currency='USD')
2025-10-31 18:30:53,343 [ERROR] Error 200, reqId 80993: No security definition has been found for the request, contract: Option(symbol='AAPU', lastTradeDateOrContractMonth='20251031', strike=38.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:30:53,343 [WARNING] Unknown contract: Option(symbol='AAPU', lastTradeDateOrContractMonth='20251031', strike=38.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:30:53,421 [ERROR] Error 200, reqId 80994: No security definition has been found for the request, contract: Option(symbol='AAPU', lastTradeDateOrContractMonth='20251031', strike=38.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:30:53,422 [WARNING] Unknown contract: Option(symbol='AAPU', lastTradeDateOrContractMonth='20251031', strike=38.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:30:53,422 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:30:53,423 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:30:53,423 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:30:53,424 [INFO] 🕯️ Candlestick Patterns (1H): {}
2025-10-31 18:30:53,424 [INFO] 🕯️ Active Candlestick Patterns (1H): none
2025-10-31 18:30:53,424 [INFO] 🕯️ Candlestick Patterns (4H): {}
2025-10-31 18:30:53,425 [INFO] 🕯️ Active Candlestick Patterns (4H): none
2025-10-31 18:30:53,425 [INFO] 🕯️ Candlestick Patterns (1D): {}
2025-10-31 18:30:53,425 [INFO] 🕯️ Active Candlestick Patterns (1D): none
/home/appuser/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
2025-10-31 18:30:53,446 [ERROR] Failed to load LSTM model from /app/models/updated_lstm.h5: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 1, 91], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-10-31 18:30:53,484 [ERROR] Failed to load Transformer model from /app/models/updated_transformer: Error(s) in loading state_dict for Linear:
	size mismatch for bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([3]).
2025-10-31 18:30:53,485 [WARNING] Holding position: missing model artefacts detected (LSTM, Transformer).
2025-10-31 18:30:53,485 [INFO] ML decision for AAPU: HOLD
2025-10-31 18:30:53,500 [INFO] ⏳ No trade executed for AAPU. Stock decision: HOLD
2025-10-31 18:30:53,501 [INFO] No open position for AAPU; canceling any existing stop-loss orders
2025-10-31 18:30:53,560 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:30:53,561 [WARNING] Retry 1/3 after 5.719502557077125s: You must supply a method of authentication
2025-10-31 18:30:59,212 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:30:59,212 [WARNING] Retry 2/3 after 10.358468285036999s: You must supply a method of authentication
2025-10-31 18:31:09,571 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:31:09,572 [ERROR] ❌ Error fetching S&P 500 data: You must supply a method of authentication. Falling back to Investing.com.
2025-10-31 18:31:09,734 [INFO] HTTP Request: GET https://www.investing.com/indices/s-p-500-stocks-above-20-day-average "HTTP/1.1 200 OK"
2025-10-31 18:31:09,817 [INFO] ✅ Investing.com S5TW fetched successfully: 34.79% above 20-day MA
2025-10-31 18:31:11,962 [ERROR] Error 200, reqId 80998: No security definition has been found for the request, contract: Option(symbol='NVDU', lastTradeDateOrContractMonth='20251031', right='C', exchange='SMART', currency='USD')
2025-10-31 18:31:16,994 [ERROR] Error 200, reqId 80999: No security definition has been found for the request, contract: Option(symbol='NVDU', lastTradeDateOrContractMonth='20251107', right='C', exchange='SMART', currency='USD')
2025-10-31 18:31:22,032 [ERROR] Error 200, reqId 81000: No security definition has been found for the request, contract: Option(symbol='NVDU', lastTradeDateOrContractMonth='20251114', right='C', exchange='SMART', currency='USD')
2025-10-31 18:31:27,765 [ERROR] Error 200, reqId 81002: No security definition has been found for the request, contract: Option(symbol='NVDU', lastTradeDateOrContractMonth='20251031', strike=160.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:31:27,766 [WARNING] Unknown contract: Option(symbol='NVDU', lastTradeDateOrContractMonth='20251031', strike=160.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:31:27,917 [ERROR] Error 200, reqId 81003: No security definition has been found for the request, contract: Option(symbol='NVDU', lastTradeDateOrContractMonth='20251031', strike=160.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:31:27,917 [WARNING] Unknown contract: Option(symbol='NVDU', lastTradeDateOrContractMonth='20251031', strike=160.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:31:27,918 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:31:27,918 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:31:27,918 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:31:27,919 [INFO] 🕯️ Candlestick Patterns (1H): {}
2025-10-31 18:31:27,919 [INFO] 🕯️ Active Candlestick Patterns (1H): none
2025-10-31 18:31:27,920 [INFO] 🕯️ Candlestick Patterns (4H): {}
2025-10-31 18:31:27,920 [INFO] 🕯️ Active Candlestick Patterns (4H): none
2025-10-31 18:31:27,920 [INFO] 🕯️ Candlestick Patterns (1D): {}
2025-10-31 18:31:27,921 [INFO] 🕯️ Active Candlestick Patterns (1D): none
/home/appuser/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
2025-10-31 18:31:27,947 [ERROR] Failed to load LSTM model from /app/models/updated_lstm.h5: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 1, 91], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-10-31 18:31:27,985 [ERROR] Failed to load Transformer model from /app/models/updated_transformer: Error(s) in loading state_dict for Linear:
	size mismatch for bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([3]).
2025-10-31 18:31:27,986 [WARNING] Holding position: missing model artefacts detected (LSTM, Transformer).
2025-10-31 18:31:27,986 [INFO] ML decision for NVDU: HOLD
2025-10-31 18:31:28,001 [INFO] ⏳ No trade executed for NVDU. Stock decision: HOLD
2025-10-31 18:31:28,001 [INFO] No open position for NVDU; canceling any existing stop-loss orders
2025-10-31 18:31:28,060 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:31:28,060 [WARNING] Retry 1/3 after 6.416599878663581s: You must supply a method of authentication
2025-10-31 18:31:34,478 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:31:34,478 [WARNING] Retry 2/3 after 10.847441763981774s: You must supply a method of authentication
2025-10-31 18:31:45,326 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:31:45,326 [ERROR] ❌ Error fetching S&P 500 data: You must supply a method of authentication. Falling back to Investing.com.
2025-10-31 18:31:45,500 [INFO] HTTP Request: GET https://www.investing.com/indices/s-p-500-stocks-above-20-day-average "HTTP/1.1 200 OK"
2025-10-31 18:31:45,569 [INFO] ✅ Investing.com S5TW fetched successfully: 34.79% above 20-day MA
2025-10-31 18:31:47,713 [ERROR] Error 200, reqId 81007: No security definition has been found for the request, contract: Option(symbol='XPP', lastTradeDateOrContractMonth='20251031', right='C', exchange='SMART', currency='USD')
2025-10-31 18:31:52,753 [ERROR] Error 200, reqId 81008: No security definition has been found for the request, contract: Option(symbol='XPP', lastTradeDateOrContractMonth='20251107', right='C', exchange='SMART', currency='USD')
2025-10-31 18:31:57,704 [ERROR] Error 200, reqId 81009: No security definition has been found for the request, contract: Option(symbol='XPP', lastTradeDateOrContractMonth='20251114', right='C', exchange='SMART', currency='USD')
2025-10-31 18:32:02,997 [ERROR] Error 200, reqId 81011: No security definition has been found for the request, contract: Option(symbol='XPP', lastTradeDateOrContractMonth='20251031', strike=29.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:32:02,998 [WARNING] Unknown contract: Option(symbol='XPP', lastTradeDateOrContractMonth='20251031', strike=29.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:32:03,076 [ERROR] Error 200, reqId 81012: No security definition has been found for the request, contract: Option(symbol='XPP', lastTradeDateOrContractMonth='20251031', strike=29.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:32:03,076 [WARNING] Unknown contract: Option(symbol='XPP', lastTradeDateOrContractMonth='20251031', strike=29.0, right='C', multiplier='100', exchange='SMART', currency='USD')
2025-10-31 18:32:03,077 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:32:03,077 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:32:03,078 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:32:03,078 [INFO] 🕯️ Candlestick Patterns (1H): {}
2025-10-31 18:32:03,078 [INFO] 🕯️ Active Candlestick Patterns (1H): none
2025-10-31 18:32:03,079 [INFO] 🕯️ Candlestick Patterns (4H): {}
2025-10-31 18:32:03,079 [INFO] 🕯️ Active Candlestick Patterns (4H): none
2025-10-31 18:32:03,079 [INFO] 🕯️ Candlestick Patterns (1D): {}
2025-10-31 18:32:03,080 [INFO] 🕯️ Active Candlestick Patterns (1D): none
/home/appuser/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
2025-10-31 18:32:03,102 [ERROR] Failed to load LSTM model from /app/models/updated_lstm.h5: Error when deserializing class 'InputLayer' using config={'batch_shape': [None, 1, 91], 'dtype': 'float32', 'sparse': False, 'ragged': False, 'name': 'input_layer'}.

Exception encountered: Unrecognized keyword arguments: ['batch_shape']
2025-10-31 18:32:03,142 [ERROR] Failed to load Transformer model from /app/models/updated_transformer: Error(s) in loading state_dict for Linear:
	size mismatch for bias: copying a param with shape torch.Size([2]) from checkpoint, the shape in current model is torch.Size([3]).
2025-10-31 18:32:03,143 [WARNING] Holding position: missing model artefacts detected (LSTM, Transformer).
2025-10-31 18:32:03,144 [INFO] ML decision for XPP: HOLD
2025-10-31 18:32:03,159 [INFO] ⏳ No trade executed for XPP. Stock decision: HOLD
2025-10-31 18:32:03,159 [INFO] No open position for XPP; canceling any existing stop-loss orders
2025-10-31 18:32:03,218 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:32:03,219 [WARNING] Retry 1/3 after 5.881315277496038s: You must supply a method of authentication
2025-10-31 18:32:09,101 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:32:09,101 [WARNING] Retry 2/3 after 11.00433798821221s: You must supply a method of authentication
2025-10-31 18:32:20,106 [INFO] Fetching SPX historical data for 1 day over 21 D via Alpaca.
2025-10-31 18:32:20,106 [ERROR] ❌ Error fetching S&P 500 data: You must supply a method of authentication. Falling back to Investing.com.
2025-10-31 18:32:20,266 [INFO] HTTP Request: GET https://www.investing.com/indices/s-p-500-stocks-above-20-day-average "HTTP/1.1 200 OK"
2025-10-31 18:32:20,350 [INFO] ✅ Investing.com S5TW fetched successfully: 34.79% above 20-day MA
2025-10-31 18:32:27,711 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:32:27,711 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:32:27,711 [WARNING] Invalid Fibonacci string. Returning default [0] * 5.
2025-10-31 18:32:27,712 [INFO] 🕯️ Candlestick Patterns (1H): {}
2025-10-31 18:32:27,712 [INFO] 🕯️ Active Candlestick Patterns (1H): none
2025-10-31 18:32:27,713 [INFO] 🕯️ Candlestick Patterns (4H): {}
2025-10-31 18:32:27,713 [INFO] 🕯️ Active Candlestick Patterns (4H): none
2025-10-31 18:32:27,713 [INFO] 🕯️ Candlestick Patterns (1D): {}
2025-10-31 18:32:27,714 [INFO] 🕯️ Active Candlestick Patterns (1D): none
/home/appuser/.local/lib/python3.12/site-packages/sklearn/utils/validation.py:2749: UserWarning: X does not have valid feature names, but LGBMClassifier was fitted with feature names
  warnings.warn(
2025-10-31 18:32:27,726 [WARNING] LSTM model artifact missing. Attempting automatic retraining using /app/lstm_config.json.
2025-10-31 18:32:37,386 [INFO] Filtered to Buy/Sell only. Remaining rows: 418973 (unique decisions=2)
2025-10-31 18:32:54,345 [INFO] Applied SMOTE oversampling. New shape: (450684, 133)
2025-11-07 13:12:29.202306: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 13:12:29.312222: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 13:12:29.350122: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 13:12:29.361443: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 13:12:29.437144: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 13:12:36,985 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
2025-11-07 13:12:37,999 [INFO] NVIDIA runtime not detected. Forcing TensorFlow to CPU mode before import.
2025-11-07 13:12:38.135791: E external/local_xla/xla/stream_executor/cuda/cuda_driver.cc:266] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2025-11-07 13:12:38,136 [INFO] No GPU detected. TensorFlow will run on CPU. If you expected GPU support, confirm the NVIDIA drivers, container runtime, and '--gpus all' flag (for Docker) are configured.
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 06:00:03.326522: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 06:00:03.428212: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 06:00:03.475778: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 06:00:03.490850: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 06:00:03.570884: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 06:00:12,425 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762495212.623667    7008 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762495212.634622    7008 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762495212.634936    7008 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 06:00:12,635 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 07:00:03.980956: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 07:00:04.121040: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 07:00:04.223895: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 07:00:04.256764: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 07:00:04.373432: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 07:00:15,616 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762498815.861730    7077 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762498815.870048    7077 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762498815.870360    7077 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 07:00:15,870 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 08:00:03.964545: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 08:00:04.110395: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 08:00:04.219777: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 08:00:04.252390: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 08:00:04.369180: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 08:00:15,777 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762502415.993787    7146 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762502416.000198    7146 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762502416.000511    7146 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 08:00:16,000 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 09:00:01.739137: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 09:00:01.748592: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 09:00:01.758022: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 09:00:01.761302: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 09:00:01.769631: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 09:00:06,938 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762506007.073217    7437 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762506007.079594    7437 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762506007.079850    7437 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 09:00:07,080 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 10:00:01.604181: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 10:00:01.613611: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 10:00:01.623299: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 10:00:01.626637: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 10:00:01.635285: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 10:00:05,065 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762509605.161373    7506 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762509605.163149    7506 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762509605.163379    7506 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 10:00:05,163 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 11:00:01.986003: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 11:00:01.995017: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 11:00:02.004822: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 11:00:02.008105: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 11:00:02.016164: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 11:00:05,472 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762513205.568754    7575 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762513205.570503    7575 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762513205.570717    7575 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 11:00:05,570 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 12:00:02.174063: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 12:00:02.182671: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 12:00:02.191242: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 12:00:02.194414: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 12:00:02.201934: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 12:00:05,639 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762516805.729697    7644 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762516805.731822    7644 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762516805.732091    7644 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 12:00:05,732 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 13:00:01.852384: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 13:00:01.862964: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 13:00:01.873566: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 13:00:01.877772: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 13:00:01.887311: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 13:00:06,978 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762520407.075384    8262 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762520407.077023    8262 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762520407.077238    8262 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 13:00:07,077 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 14:00:02.279537: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 14:00:02.290767: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 14:00:02.302882: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 14:00:02.308621: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 14:00:02.322128: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 14:00:08,019 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762524008.137843   11171 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762524008.144395   11171 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762524008.144753   11171 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 14:00:08,145 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 15:00:02.444251: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 15:00:02.453294: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 15:00:02.462975: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 15:00:02.466663: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 15:00:02.474729: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 15:00:06,027 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762527606.123203   22906 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762527606.124975   22906 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762527606.125216   22906 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 15:00:06,125 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 16:00:03.143044: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 16:00:03.265466: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 16:00:03.315926: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 16:00:03.331488: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 16:00:03.424068: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 16:00:11,471 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762531211.634286   30983 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762531211.642902   30983 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762531211.643564   30983 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 16:00:11,643 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 17:00:03.844293: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 17:00:03.950227: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 17:00:04.036630: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 17:00:04.064694: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 17:00:04.140645: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 17:00:11,454 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762534811.586739   32396 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762534811.592466   32396 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762534811.592835   32396 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 17:00:11,593 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 18:00:01.771079: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 18:00:01.780150: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 18:00:01.789707: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 18:00:01.793000: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 18:00:01.800686: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 18:00:05,256 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762538405.355064   32465 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762538405.357057   32465 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762538405.357410   32465 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 18:00:05,357 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 19:00:01.592165: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 19:00:01.601268: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 19:00:01.611783: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 19:00:01.615308: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 19:00:01.624452: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 19:00:05,073 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762542005.178031   32534 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762542005.179900   32534 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762542005.180193   32534 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 19:00:05,180 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 20:00:02.543971: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 20:00:02.553472: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 20:00:02.563556: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 20:00:02.567156: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 20:00:02.575515: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 20:00:06,110 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762545606.210744   32606 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762545606.212426   32606 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762545606.212716   32606 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 20:00:06,213 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 21:00:02.326032: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 21:00:02.334678: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 21:00:02.343686: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 21:00:02.346864: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 21:00:02.355983: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 21:00:05,771 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762549205.870530   32675 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762549205.872550   32675 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762549205.872840   32675 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 21:00:05,873 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 22:00:02.036731: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 22:00:02.045376: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 22:00:02.054775: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 22:00:02.058040: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 22:00:02.066075: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 22:00:05,514 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762552805.618458   32744 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762552805.620082   32744 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762552805.620296   32744 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 22:00:05,620 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-07 23:00:01.809743: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-07 23:00:01.818591: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-07 23:00:01.827679: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-07 23:00:01.830791: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-07 23:00:01.838559: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-07 23:00:05,752 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762556405.849296   32899 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762556405.850745   32899 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762556405.850954   32899 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-07 23:00:05,851 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-08 00:00:02.225020: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 00:00:02.233475: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 00:00:02.242350: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 00:00:02.245324: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 00:00:02.253071: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-08 00:00:05,648 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762560005.741897   33021 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762560005.743477   33021 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762560005.743694   33021 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-08 00:00:05,744 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-08 01:00:02.621254: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 01:00:02.657685: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 01:00:02.683112: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 01:00:02.691010: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 01:00:02.723307: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-08 01:00:07,289 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762563607.391492   33090 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762563607.394958   33090 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762563607.395198   33090 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-08 01:00:07,395 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-08 02:00:02.411514: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 02:00:02.420543: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 02:00:02.430021: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 02:00:02.433632: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 02:00:02.441725: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-08 02:00:06,074 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762567206.172939   33303 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762567206.174673   33303 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762567206.175009   33303 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-08 02:00:06,175 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-08 03:00:03.309120: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 03:00:03.434430: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 03:00:03.523500: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 03:00:03.552408: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 03:00:03.655357: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-08 03:00:13,595 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762570813.794539   33372 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762570813.800303   33372 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762570813.800629   33372 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-08 03:00:13,800 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-08 11:52:47.855701: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 11:52:47.895129: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 11:52:47.929787: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 11:52:47.938212: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 11:52:47.970527: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-08 11:52:53,173 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
2025-11-08 11:52:54,190 [INFO] NVIDIA runtime not detected. Forcing TensorFlow to CPU mode before import.
2025-11-08 11:52:54.295230: E external/local_xla/xla/stream_executor/cuda/cuda_driver.cc:266] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2025-11-08 11:52:54,295 [INFO] No GPU detected. TensorFlow will run on CPU. If you expected GPU support, confirm the NVIDIA drivers, container runtime, and '--gpus all' flag (for Docker) are configured.
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-08 04:00:02.638032: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 04:00:02.648691: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 04:00:02.660026: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 04:00:02.664527: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 04:00:02.675476: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-08 04:00:07,217 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762574407.328116   10629 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762574407.334653   10629 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762574407.334998   10629 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-08 04:00:07,335 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-08 05:00:03.295780: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 05:00:03.320448: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 05:00:03.346441: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 05:00:03.352634: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 05:00:03.376536: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-08 05:00:12,046 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762578012.267092   87909 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762578012.271182   87909 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762578012.271564   87909 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-08 05:00:12,271 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-08 13:51:40.750642: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 13:51:40.784226: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 13:51:40.803531: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 13:51:40.809998: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 13:51:40.831371: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-08 13:51:46,540 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
2025-11-08 13:51:47,552 [INFO] NVIDIA runtime not detected. Forcing TensorFlow to CPU mode before import.
2025-11-08 13:51:47.683740: E external/local_xla/xla/stream_executor/cuda/cuda_driver.cc:266] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
2025-11-08 13:51:47,684 [INFO] No GPU detected. TensorFlow will run on CPU. If you expected GPU support, confirm the NVIDIA drivers, container runtime, and '--gpus all' flag (for Docker) are configured.
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-08 06:01:25.337466: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 06:01:26.017781: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 06:01:26.283725: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 06:01:26.430066: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 06:01:26.595421: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-08 06:01:37,641 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762581697.897606   58400 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762581697.903801   58400 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762581697.904062   58400 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-08 06:01:37,904 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-08 07:00:05.749845: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 07:00:06.050237: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 07:00:06.199515: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 07:00:06.245900: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 07:00:06.426797: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-08 07:00:21,071 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762585221.467768   27980 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762585221.477440   27980 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762585221.477850   27980 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-08 07:00:21,478 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-08 08:00:04.351796: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 08:00:04.551236: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 08:00:04.651092: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 08:00:04.682368: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 08:00:04.806336: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-08 08:00:17,521 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762588817.841008   28133 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762588817.849962   28133 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762588817.850469   28133 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-08 08:00:17,850 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 86, in <module>
    from ibkr_utils import format_duration, round_to_min_tick, get_round_lot_size
ImportError: cannot import name 'get_round_lot_size' from 'ibkr_utils' (/app/ibkr_utils.py)
2025-11-08 09:00:04.462469: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 09:00:04.694913: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 09:00:04.795470: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 09:00:04.832442: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 09:00:04.966463: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 48, in <module>
    from ml_predictor import predict_with_all_models, ensemble_vote
  File "/app/ml_predictor.py", line 38, in <module>
    preds_dict, y_val, returns = load_val_data()
                                 ^^^^^^^^^^^^^^^
  File "/app/ml_predictor.py", line 19, in load_val_data
    raise FileNotFoundError(f"{path} not found!")
FileNotFoundError: /app/models/val_preds_RandomForest.npy not found!
2025-11-08 10:00:02.533220: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 10:00:02.550660: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 10:00:02.568993: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 10:00:02.574331: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 10:00:02.585768: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 48, in <module>
    from ml_predictor import predict_with_all_models, ensemble_vote
  File "/app/ml_predictor.py", line 38, in <module>
    preds_dict, y_val, returns = load_val_data()
                                 ^^^^^^^^^^^^^^^
  File "/app/ml_predictor.py", line 19, in load_val_data
    raise FileNotFoundError(f"{path} not found!")
FileNotFoundError: /app/models/val_preds_RandomForest.npy not found!
2025-11-08 11:00:02.526114: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 11:00:02.571476: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 11:00:02.645535: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 11:00:02.652856: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 11:00:02.702876: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 48, in <module>
    from ml_predictor import predict_with_all_models, ensemble_vote
  File "/app/ml_predictor.py", line 38, in <module>
    preds_dict, y_val, returns = load_val_data()
                                 ^^^^^^^^^^^^^^^
  File "/app/ml_predictor.py", line 19, in load_val_data
    raise FileNotFoundError(f"{path} not found!")
FileNotFoundError: /app/models/val_preds_RandomForest.npy not found!
2025-11-08 12:00:02.416615: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 12:00:02.458428: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 12:00:02.528468: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 12:00:02.535624: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 12:00:02.587314: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 48, in <module>
    from ml_predictor import predict_with_all_models, ensemble_vote
  File "/app/ml_predictor.py", line 38, in <module>
    preds_dict, y_val, returns = load_val_data()
                                 ^^^^^^^^^^^^^^^
  File "/app/ml_predictor.py", line 19, in load_val_data
    raise FileNotFoundError(f"{path} not found!")
FileNotFoundError: /app/models/val_preds_RandomForest.npy not found!
2025-11-08 13:00:02.103844: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 13:00:02.118419: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 13:00:02.134247: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 13:00:02.139658: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 13:00:02.152270: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 48, in <module>
    from ml_predictor import predict_with_all_models, ensemble_vote
  File "/app/ml_predictor.py", line 38, in <module>
    preds_dict, y_val, returns = load_val_data()
                                 ^^^^^^^^^^^^^^^
  File "/app/ml_predictor.py", line 19, in load_val_data
    raise FileNotFoundError(f"{path} not found!")
FileNotFoundError: /app/models/val_preds_RandomForest.npy not found!
2025-11-08 14:00:02.114362: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 14:00:02.146327: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 14:00:02.176332: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 14:00:02.188043: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 14:00:02.211498: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 48, in <module>
    from ml_predictor import predict_with_all_models, ensemble_vote
  File "/app/ml_predictor.py", line 38, in <module>
    preds_dict, y_val, returns = load_val_data()
                                 ^^^^^^^^^^^^^^^
  File "/app/ml_predictor.py", line 19, in load_val_data
    raise FileNotFoundError(f"{path} not found!")
FileNotFoundError: /app/models/val_preds_RandomForest.npy not found!
2025-11-08 15:00:03.409068: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-08 15:00:03.423481: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-08 15:00:03.439639: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-08 15:00:03.444716: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-08 15:00:03.459951: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 48, in <module>
    from ml_predictor import predict_with_all_models, ensemble_vote
  File "/app/ml_predictor.py", line 38, in <module>
    preds_dict, y_val, returns = load_val_data()
                                 ^^^^^^^^^^^^^^^
  File "/app/ml_predictor.py", line 19, in load_val_data
    raise FileNotFoundError(f"{path} not found!")
FileNotFoundError: /app/models/val_preds_RandomForest.npy not found!
2025-11-09 05:00:08.734872: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-09 05:00:08.742998: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-09 05:00:08.751142: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-09 05:00:08.754299: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-09 05:00:08.761100: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-09 05:00:13,143 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762664413.222823   93511 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762664413.226466   93511 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762664413.226647   93511 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-09 05:00:13,227 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 48, in <module>
    from ml_predictor import predict_with_all_models, ensemble_vote
  File "/app/ml_predictor.py", line 166, in <module>
    def _load_model(model_name: str, paths: Iterable[Path], *, config: Optional[Path] = None) -> object | None:
                                                                       ^^^^^^^^
NameError: name 'Optional' is not defined
2025-11-09 06:18:33.432630: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-09 06:18:33.723168: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-09 06:18:33.871733: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-09 06:18:33.901411: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-09 06:18:34.060663: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-09 06:19:11,155 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762669151.874091  319798 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762669152.093876  319798 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762669152.094127  319798 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-09 06:19:12,094 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 48, in <module>
    from ml_predictor import predict_with_all_models, ensemble_vote
  File "/app/ml_predictor.py", line 166, in <module>
    def _load_model(model_name: str, paths: Iterable[Path], *, config: Optional[Path] = None) -> object | None:
                                                                       ^^^^^^^^
NameError: name 'Optional' is not defined
2025-11-09 07:00:53.720591: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-09 07:01:17.825819: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-09 07:01:25.549125: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-09 07:01:30.650180: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-09 07:01:54.379587: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-09 07:34:51,271 [INFO] Using built-in heuristic candlestick pattern approximations for candlestick analysis.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1762673691.525398  317344 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762673691.532697  317344 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
I0000 00:00:1762673691.532915  317344 cuda_executor.cc:1001] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2025-11-09 07:34:51,533 [INFO] TensorFlow detected 1 GPU(s).
TensorFlow GPU devices: [PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 48, in <module>
    from ml_predictor import predict_with_all_models, ensemble_vote
  File "/app/ml_predictor.py", line 166, in <module>
    def _load_model(model_name: str, paths: Iterable[Path], *, config: Optional[Path] = None) -> object | None:
                                                                       ^^^^^^^^
NameError: name 'Optional' is not defined
2025-11-10 12:25:03.767978: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-11-10 12:25:03.985344: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-11-10 12:25:04.572497: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8473] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-11-10 12:25:04.796538: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1471] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-11-10 12:25:06.188315: I tensorflow/core/platform/cpu_feature_guard.cc:211] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE3 SSE4.1 SSE4.2 AVX, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 37, in <module>
    from keras.models import load_model
ModuleNotFoundError: No module named 'keras'
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 37, in <module>
    from keras.models import load_model
ModuleNotFoundError: No module named 'keras'
Traceback (most recent call last):
  File "/app/tsla_ai_master_final_ready.py", line 37, in <module>
    from keras.models import load_model
ModuleNotFoundError: No module named 'keras'
